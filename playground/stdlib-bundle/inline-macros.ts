export const macroBundlesContent = {"CodeExpression":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvVmFsdWVzL0NvZGVFeHByZXNzaW9uLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvVmFsdWVzL0NvZGVFeHByZXNzaW9uLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IGdldElubGluZVZhcmlhYmxlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXRJbmxpbmVWYXJpYWJsZXMgKi8gXCIuL3NyYy9WYWx1ZXMvZ2V0SW5saW5lVmFyaWFibGVzLnRzXCIpO1xuY29uc3QgbGFiZWxNYXhMZW5ndGggPSAyMDtcbmZ1bmN0aW9uIHZhbFRvTGFiZWwodmFsKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbGFiZWwgPSBKU09OLnN0cmluZ2lmeSh2YWwpO1xuICAgICAgICBpZiAobGFiZWwubGVuZ3RoID4gbGFiZWxNYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtsYWJlbC5zbGljZSgwLCBsYWJlbE1heExlbmd0aCl9Li4uYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBgVmFsdWVgO1xuICAgIH1cbn1cbmNvbnN0IENvZGVFeHByZXNzaW9uRWRpdG9yID0gZnVuY3Rpb24gQ29kZUV4cHJlc3Npb25FZGl0b3IocHJvcHMpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyB2YWx1ZSwgb25DaGFuZ2UgfSA9IHByb3BzO1xuICAgIGNvbnN0IGNoYW5nZVZhbHVlID0gKDAsIHJlYWN0XzEudXNlQ2FsbGJhY2spKChfdmFsKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld0xhYmVsID0gdmFsVG9MYWJlbChfdmFsKTtcbiAgICAgICAgY29uc3Qgb2xkTGFiZWwgPSB2YWxUb0xhYmVsKHZhbHVlLnZhbHVlKTtcbiAgICAgICAgY29uc3Qgd2FzVXNpbmdEZWZhdWx0TGFiZWwgPSB2YWx1ZS5sYWJlbCA9PT0gb2xkTGFiZWwgfHwgIXZhbHVlLmxhYmVsO1xuICAgICAgICBjb25zdCBsYWJlbFRvVXNlID0gd2FzVXNpbmdEZWZhdWx0TGFiZWwgPyBuZXdMYWJlbCA6IHZhbHVlLmxhYmVsO1xuICAgICAgICBvbkNoYW5nZSh7IC4uLnZhbHVlLCB2YWx1ZTogX3ZhbCwgbGFiZWw6IGxhYmVsVG9Vc2UgfSk7XG4gICAgfSwgW3ZhbHVlLCBvbkNoYW5nZV0pO1xuICAgIGNvbnN0IHZhcnMgPSAoMCwgZ2V0SW5saW5lVmFyaWFibGVzXzEuZ2V0VmFyaWFibGVzKSgoX2EgPSB2YWx1ZS52YWx1ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogXCJcIik7XG4gICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLCBudWxsLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlOlwiLCBoZWxwZXJUZXh0OiBgQWNjZXB0cyBhbnkgdmFsaWQgSlMgZXh0ZW5zaW9uLiBgIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuVGV4dEFyZWEsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBmaWxsOiB0cnVlLCBvbkNoYW5nZTogKGUpID0+IGNoYW5nZVZhbHVlKGUudGFyZ2V0LnZhbHVlKSB9KSksXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIG51bGwsIHZhcnMubGVuZ3RoID4gMCA/IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcInNtYWxsXCIsIG51bGwsXG4gICAgICAgICAgICBcIkV4dGVybmFsIGlucHV0cyBleHBvc2VkIGZyb20gdGhpcyBleHByZXNzaW9uOlwiLFxuICAgICAgICAgICAgXCIgXCIsXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcImVtXCIsIG51bGwsIHZhcnMuam9pbihcIiwgXCIpKSkpIDogKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwic21hbGxcIiwgbnVsbCwgXCJFeHBvc2UgZXh0ZXJuYWwgaW5wdXRzIGJ5IHVzaW5nIHRoZSBcXFwiaW5wdXRzXFxcIiBvYmplY3QuIEZvciBleGFtcGxlLCBcXFwiaW5wdXRzLmEgKyBpbnB1dHMuYlxcXCIgd2lsbCBleHBvc2UgMiBpbnB1dHMsIGEgYW5kIGIsIGFuZCBzdW0gdGhlbS5cIikpKSxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJMYWJlbDpcIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdHlwZTogXCJ0ZXh0XCIsIHZhbHVlOiB2YWx1ZS5sYWJlbCwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCBsYWJlbDogZS50YXJnZXQudmFsdWUgfSksIHBsYWNlaG9sZGVyOiBcIkNvZGUgRXhwcmVzc2lvblwiIH0pKSkpO1xufTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQ29kZUV4cHJlc3Npb25FZGl0b3I7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vX19NYWNyb05vZGVfX0NvZGVFeHByZXNzaW9uLy4vc3JjL1ZhbHVlcy9Db2RlRXhwcmVzc2lvbi50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9WYWx1ZXMvZ2V0SW5saW5lVmFyaWFibGVzLnRzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9WYWx1ZXMvZ2V0SW5saW5lVmFyaWFibGVzLnRzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgpldmFsKCJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuZXhwb3J0cy5nZXRWYXJpYWJsZXMgPSB2b2lkIDA7XG5jb25zdCBnZXRWYXJpYWJsZXMgPSAoY29kZSkgPT4ge1xuICAgIHJldHVybiAoY29kZS5tYXRjaCgvaW5wdXRzXFwuKFthLXpBLVpdXFx3KikvZykgfHwgW10pLm1hcCgodikgPT4gdi5yZXBsYWNlKC9pbnB1dHNcXC4vLCBcIlwiKSk7XG59O1xuZXhwb3J0cy5nZXRWYXJpYWJsZXMgPSBnZXRWYXJpYWJsZXM7XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vX19NYWNyb05vZGVfX0NvZGVFeHByZXNzaW9uLy4vc3JjL1ZhbHVlcy9nZXRJbmxpbmVWYXJpYWJsZXMudHM/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIlJlYWN0Il07CgovKioqLyB9KQoKLyoqKioqKi8gCX0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJCi8qKioqKiovIAkvLyBzdGFydHVwCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCS8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oIi4vc3JjL1ZhbHVlcy9Db2RlRXhwcmVzc2lvbi50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fQ29kZUV4cHJlc3Npb24gPSBfX3dlYnBhY2tfZXhwb3J0c19fOwovKioqKioqLyAJCi8qKioqKiovIH0pKCkKOw==","Collect":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvTGlzdHMvQ29sbGVjdC9Db2xsZWN0LnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvTGlzdHMvQ29sbGVjdC9Db2xsZWN0LnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuY29uc3QgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQGJsdWVwcmludGpzL2NvcmUgKi8gXCJAYmx1ZXByaW50anMvY29yZVwiKTtcbmNvbnN0IHJlYWN0XzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCJyZWFjdFwiKSk7XG5jb25zdCBDb25maWd1cmFibGVJbnB1dEVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vLi4vbGliL0NvbmZpZ3VyYWJsZUlucHV0RWRpdG9yICovIFwiLi9zcmMvbGliL0NvbmZpZ3VyYWJsZUlucHV0RWRpdG9yLnRzeFwiKTtcbmNvbnN0IGRlZmF1bHRWYWx1ZVBlclN0cmF0ZWd5ID0ge1xuICAgIGNvdW50OiB7XG4gICAgICAgIHN0cmF0ZWd5OiBcImNvdW50XCIsXG4gICAgICAgIGNvdW50OiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiAyIH0sXG4gICAgfSxcbiAgICB0aW1lOiB7XG4gICAgICAgIHN0cmF0ZWd5OiBcInRpbWVcIixcbiAgICAgICAgdGltZTogeyBtb2RlOiBcInN0YXRpY1wiLCB2YWx1ZTogMjAwMCB9LFxuICAgIH0sXG4gICAgdHJpZ2dlcjoge1xuICAgICAgICBzdHJhdGVneTogXCJ0cmlnZ2VyXCIsXG4gICAgfSxcbn07XG5jb25zdCBDb2xsZWN0RWRpdG9yID0gZnVuY3Rpb24gQ29sbGVjdEVkaXRvcih7IHZhbHVlLCBvbkNoYW5nZSwgfSkge1xuICAgIGNvbnN0IGhhbmRsZVN0cmF0ZWd5Q2hhbmdlID0gcmVhY3RfMS5kZWZhdWx0LnVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gZS5jdXJyZW50VGFyZ2V0LnZhbHVlO1xuICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWVQZXJTdHJhdGVneVtzdHJhdGVneV07XG4gICAgICAgIG9uQ2hhbmdlKGRlZmF1bHRWYWx1ZSk7XG4gICAgfSwgW29uQ2hhbmdlLCB2YWx1ZV0pO1xuICAgIGNvbnN0IGlubmVyRWRpdG9yID0gcmVhY3RfMS5kZWZhdWx0LnVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBzd2l0Y2ggKHZhbHVlLnN0cmF0ZWd5KSB7XG4gICAgICAgICAgICBjYXNlIFwiY291bnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbmZpZ3VyYWJsZUlucHV0RWRpdG9yXzEuQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IsIHsgdmFsdWU6IHZhbHVlLmNvdW50LCBvbkNoYW5nZTogKGNvdW50KSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCBjb3VudCB9KSwgdmFsdWVSZW5kZXJlcjogKHByb3BzKSA9PiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJDb3VudDpcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuTnVtZXJpY0lucHV0LCB7IHZhbHVlOiBwcm9wcy52YWx1ZSwgb25WYWx1ZUNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiBlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSkpKSwgbW9kZUxhYmVsOiBcIkNvdW50IG1vZGU6XCIsIGRlZmF1bHRTdGF0aWNWYWx1ZTogMiB9KSk7XG4gICAgICAgICAgICBjYXNlIFwidGltZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29uZmlndXJhYmxlSW5wdXRFZGl0b3JfMS5Db25maWd1cmFibGVJbnB1dEVkaXRvciwgeyB2YWx1ZTogdmFsdWUudGltZSwgb25DaGFuZ2U6ICh0aW1lKSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCB0aW1lIH0pLCB2YWx1ZVJlbmRlcmVyOiAocHJvcHMpID0+IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlRpbWU6XCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLk51bWVyaWNJbnB1dCwgeyB2YWx1ZTogcHJvcHMudmFsdWUsIG9uVmFsdWVDaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lOiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiBlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSkpKSwgbW9kZUxhYmVsOiBcIlRpbWUgbW9kZTpcIiwgZGVmYXVsdFN0YXRpY1ZhbHVlOiAyMDAwIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIFt2YWx1ZSwgb25DaGFuZ2VdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvR3JvdXAsIHsgbGFiZWw6IFwiQ29sbGVjdGlvbiBzdHJhdGVneTpcIiwgb25DaGFuZ2U6IGhhbmRsZVN0cmF0ZWd5Q2hhbmdlLCBzZWxlY3RlZFZhbHVlOiB2YWx1ZS5zdHJhdGVneSwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuUmFkaW8sIHsgbGFiZWw6IFwiQ291bnRcIiwgdmFsdWU6IFwiY291bnRcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJUaW1lXCIsIHZhbHVlOiBcInRpbWVcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJEeW5hbWljXCIsIHZhbHVlOiBcInRyaWdnZXJcIiB9KSksXG4gICAgICAgIGlubmVyRWRpdG9yKSk7XG59O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDb2xsZWN0RWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2xsZWN0Ly4vc3JjL0xpc3RzL0NvbGxlY3QvQ29sbGVjdC50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9saWIvQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IudHN4IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9saWIvQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IudHN4ICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLmNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yID0gZXhwb3J0cy5Db25maWd1cmFibGVJbnB1dEVkaXRvciA9IHZvaWQgMDtcbmNvbnN0IGNvcmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBibHVlcHJpbnRqcy9jb3JlICovIFwiQGJsdWVwcmludGpzL2NvcmVcIik7XG5jb25zdCByZWFjdF8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIikpO1xuY29uc3QgQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IgPSBmdW5jdGlvbiAoeyB2YWx1ZSwgb25DaGFuZ2UsIHZhbHVlUmVuZGVyZXI6IFZhbHVlUmVuZGVyZXIsIGRlZmF1bHRTdGF0aWNWYWx1ZSwgbW9kZUxhYmVsLCB9KSB7XG4gICAgY29uc3QgaGFuZGxlTW9kZUNoYW5nZSA9IChlKSA9PiB7XG4gICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgIG1vZGU6IGUuY3VycmVudFRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlLmN1cnJlbnRUYXJnZXQudmFsdWUgPT09IFwic3RhdGljXCIgPyBkZWZhdWx0U3RhdGljVmFsdWUgOiB1bmRlZmluZWQsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlVmFsdWVDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBtb2RlOiBcInN0YXRpY1wiLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICBjb25zdCBNZW1vVmFsdWVSZW5kZXJlciA9IHJlYWN0XzEuZGVmYXVsdC51c2VNZW1vKCgpID0+IFZhbHVlUmVuZGVyZXIsIFtdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvR3JvdXAsIHsgbGFiZWw6IG1vZGVMYWJlbCwgb25DaGFuZ2U6IGhhbmRsZU1vZGVDaGFuZ2UsIHNlbGVjdGVkVmFsdWU6IHZhbHVlLm1vZGUsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvLCB7IGxhYmVsOiBcIlN0YXRpY1wiLCB2YWx1ZTogXCJzdGF0aWNcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJEeW5hbWljXCIsIHZhbHVlOiBcImR5bmFtaWNcIiB9KSksXG4gICAgICAgIHZhbHVlLm1vZGUgPT09IFwic3RhdGljXCIgPyAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTWVtb1ZhbHVlUmVuZGVyZXIsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBvbkNoYW5nZTogaGFuZGxlVmFsdWVDaGFuZ2UgfSkpIDogbnVsbCkpO1xufTtcbmV4cG9ydHMuQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IgPSBDb25maWd1cmFibGVJbnB1dEVkaXRvcjtcbmNvbnN0IGNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yID0gKHZhbHVlUmVuZGVyZXIpID0+IHtcbiAgICByZXR1cm4gKHByb3BzKSA9PiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoZXhwb3J0cy5Db25maWd1cmFibGVJbnB1dEVkaXRvciwgeyAuLi5wcm9wcywgdmFsdWVSZW5kZXJlcjogdmFsdWVSZW5kZXJlciB9KSk7XG59O1xuZXhwb3J0cy5jcmVhdGVDb25maWd1cmFibGVJbnB1dEVkaXRvciA9IGNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2xsZWN0Ly4vc3JjL2xpYi9Db25maWd1cmFibGVJbnB1dEVkaXRvci50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIlJlYWN0Il07CgovKioqLyB9KQoKLyoqKioqKi8gCX0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJCi8qKioqKiovIAkvLyBzdGFydHVwCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCS8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oIi4vc3JjL0xpc3RzL0NvbGxlY3QvQ29sbGVjdC50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fQ29sbGVjdCA9IF9fd2VicGFja19leHBvcnRzX187Ci8qKioqKiovIAkKLyoqKioqKi8gfSkoKQo7","Conditional":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3B1YnN1Yi1qc0AxLjkuNC9ub2RlX21vZHVsZXMvcHVic3ViLWpzL3NyYy9wdWJzdWIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi9ub2RlX21vZHVsZXMvLnBucG0vcHVic3ViLWpzQDEuOS40L25vZGVfbW9kdWxlcy9wdWJzdWItanMvc3JjL3B1YnN1Yi5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIi8qIG1vZHVsZSBkZWNvcmF0b3IgKi8gbW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5ubWQobW9kdWxlKTtcbi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEwLDIwMTEsMjAxMiwyMDEzLDIwMTQgTW9yZ2FuIFJvZGVyaWNrIGh0dHA6Ly9yb2Rlcmljay5ka1xuICogTGljZW5zZTogTUlUIC0gaHR0cDovL21yZ25yZHJjay5taXQtbGljZW5zZS5vcmdcbiAqXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbXJvZGVyaWNrL1B1YlN1YkpTXG4gKi9cblxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgUHViU3ViID0ge307XG5cbiAgICBpZiAocm9vdC5QdWJTdWIpIHtcbiAgICAgICAgUHViU3ViID0gcm9vdC5QdWJTdWI7XG4gICAgICAgIGNvbnNvbGUud2FybihcIlB1YlN1YiBhbHJlYWR5IGxvYWRlZCwgdXNpbmcgZXhpc3RpbmcgdmVyc2lvblwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb290LlB1YlN1YiA9IFB1YlN1YjtcbiAgICAgICAgZmFjdG9yeShQdWJTdWIpO1xuICAgIH1cbiAgICAvLyBDb21tb25KUyBhbmQgTm9kZS5qcyBtb2R1bGUgc3VwcG9ydFxuICAgIGlmICh0cnVlKXtcbiAgICAgICAgaWYgKG1vZHVsZSAhPT0gdW5kZWZpbmVkICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBQdWJTdWI7IC8vIE5vZGUuanMgc3BlY2lmaWMgYG1vZHVsZS5leHBvcnRzYFxuICAgICAgICB9XG4gICAgICAgIGV4cG9ydHMuUHViU3ViID0gUHViU3ViOyAvLyBDb21tb25KUyBtb2R1bGUgMS4xLjEgc3BlY1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBQdWJTdWI7IC8vIENvbW1vbkpTXG4gICAgfVxuICAgIC8vIEFNRCBzdXBwb3J0XG4gICAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbiAgICBlbHNlIHt9XG5cbn0oKCB0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cgKSB8fCB0aGlzLCBmdW5jdGlvbiAoUHViU3ViKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgbWVzc2FnZXMgPSB7fSxcbiAgICAgICAgbGFzdFVpZCA9IC0xLFxuICAgICAgICBBTExfU1VCU0NSSUJJTkdfTVNHID0gJyonO1xuXG4gICAgZnVuY3Rpb24gaGFzS2V5cyhvYmope1xuICAgICAgICB2YXIga2V5O1xuXG4gICAgICAgIGZvciAoa2V5IGluIG9iail7XG4gICAgICAgICAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgdGhyb3dzIHRoZSBwYXNzZWQgZXhjZXB0aW9uLCBmb3IgdXNlIGFzIGFyZ3VtZW50IGZvciBzZXRUaW1lb3V0XG4gICAgICogQGFsaWFzIHRocm93RXhjZXB0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZXggQW4gRXJyb3Igb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gdGhyb3dFeGNlcHRpb24oIGV4ICl7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiByZVRocm93RXhjZXB0aW9uKCl7XG4gICAgICAgICAgICB0aHJvdyBleDtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxsU3Vic2NyaWJlcldpdGhEZWxheWVkRXhjZXB0aW9ucyggc3Vic2NyaWJlciwgbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3Vic2NyaWJlciggbWVzc2FnZSwgZGF0YSApO1xuICAgICAgICB9IGNhdGNoKCBleCApe1xuICAgICAgICAgICAgc2V0VGltZW91dCggdGhyb3dFeGNlcHRpb24oIGV4ICksIDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsbFN1YnNjcmliZXJXaXRoSW1tZWRpYXRlRXhjZXB0aW9ucyggc3Vic2NyaWJlciwgbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICBzdWJzY3JpYmVyKCBtZXNzYWdlLCBkYXRhICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsaXZlck1lc3NhZ2UoIG9yaWdpbmFsTWVzc2FnZSwgbWF0Y2hlZE1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgdmFyIHN1YnNjcmliZXJzID0gbWVzc2FnZXNbbWF0Y2hlZE1lc3NhZ2VdLFxuICAgICAgICAgICAgY2FsbFN1YnNjcmliZXIgPSBpbW1lZGlhdGVFeGNlcHRpb25zID8gY2FsbFN1YnNjcmliZXJXaXRoSW1tZWRpYXRlRXhjZXB0aW9ucyA6IGNhbGxTdWJzY3JpYmVyV2l0aERlbGF5ZWRFeGNlcHRpb25zLFxuICAgICAgICAgICAgcztcblxuICAgICAgICBpZiAoICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoIG1lc3NhZ2VzLCBtYXRjaGVkTWVzc2FnZSApICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChzIGluIHN1YnNjcmliZXJzKXtcbiAgICAgICAgICAgIGlmICggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHN1YnNjcmliZXJzLCBzKSl7XG4gICAgICAgICAgICAgICAgY2FsbFN1YnNjcmliZXIoIHN1YnNjcmliZXJzW3NdLCBvcmlnaW5hbE1lc3NhZ2UsIGRhdGEgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZURlbGl2ZXJ5RnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlbGl2ZXJOYW1lc3BhY2VkKCl7XG4gICAgICAgICAgICB2YXIgdG9waWMgPSBTdHJpbmcoIG1lc3NhZ2UgKSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHRvcGljLmxhc3RJbmRleE9mKCAnLicgKTtcblxuICAgICAgICAgICAgLy8gZGVsaXZlciB0aGUgbWVzc2FnZSBhcyBpdCBpcyBub3dcbiAgICAgICAgICAgIGRlbGl2ZXJNZXNzYWdlKG1lc3NhZ2UsIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyB0cmltIHRoZSBoaWVyYXJjaHkgYW5kIGRlbGl2ZXIgbWVzc2FnZSB0byBlYWNoIGxldmVsXG4gICAgICAgICAgICB3aGlsZSggcG9zaXRpb24gIT09IC0xICl7XG4gICAgICAgICAgICAgICAgdG9waWMgPSB0b3BpYy5zdWJzdHIoIDAsIHBvc2l0aW9uICk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB0b3BpYy5sYXN0SW5kZXhPZignLicpO1xuICAgICAgICAgICAgICAgIGRlbGl2ZXJNZXNzYWdlKCBtZXNzYWdlLCB0b3BpYywgZGF0YSwgaW1tZWRpYXRlRXhjZXB0aW9ucyApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWxpdmVyTWVzc2FnZShtZXNzYWdlLCBBTExfU1VCU0NSSUJJTkdfTVNHLCBkYXRhLCBpbW1lZGlhdGVFeGNlcHRpb25zKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXNEaXJlY3RTdWJzY3JpYmVyc0ZvciggbWVzc2FnZSApIHtcbiAgICAgICAgdmFyIHRvcGljID0gU3RyaW5nKCBtZXNzYWdlICksXG4gICAgICAgICAgICBmb3VuZCA9IEJvb2xlYW4oT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCBtZXNzYWdlcywgdG9waWMgKSAmJiBoYXNLZXlzKG1lc3NhZ2VzW3RvcGljXSkpO1xuXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlSGFzU3Vic2NyaWJlcnMoIG1lc3NhZ2UgKXtcbiAgICAgICAgdmFyIHRvcGljID0gU3RyaW5nKCBtZXNzYWdlICksXG4gICAgICAgICAgICBmb3VuZCA9IGhhc0RpcmVjdFN1YnNjcmliZXJzRm9yKHRvcGljKSB8fCBoYXNEaXJlY3RTdWJzY3JpYmVyc0ZvcihBTExfU1VCU0NSSUJJTkdfTVNHKSxcbiAgICAgICAgICAgIHBvc2l0aW9uID0gdG9waWMubGFzdEluZGV4T2YoICcuJyApO1xuXG4gICAgICAgIHdoaWxlICggIWZvdW5kICYmIHBvc2l0aW9uICE9PSAtMSApe1xuICAgICAgICAgICAgdG9waWMgPSB0b3BpYy5zdWJzdHIoIDAsIHBvc2l0aW9uICk7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IHRvcGljLmxhc3RJbmRleE9mKCAnLicgKTtcbiAgICAgICAgICAgIGZvdW5kID0gaGFzRGlyZWN0U3Vic2NyaWJlcnNGb3IodG9waWMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHB1Ymxpc2goIG1lc3NhZ2UsIGRhdGEsIHN5bmMsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgbWVzc2FnZSA9ICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3N5bWJvbCcpID8gbWVzc2FnZS50b1N0cmluZygpIDogbWVzc2FnZTtcblxuICAgICAgICB2YXIgZGVsaXZlciA9IGNyZWF0ZURlbGl2ZXJ5RnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKSxcbiAgICAgICAgICAgIGhhc1N1YnNjcmliZXJzID0gbWVzc2FnZUhhc1N1YnNjcmliZXJzKCBtZXNzYWdlICk7XG5cbiAgICAgICAgaWYgKCAhaGFzU3Vic2NyaWJlcnMgKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICggc3luYyA9PT0gdHJ1ZSApe1xuICAgICAgICAgICAgZGVsaXZlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0VGltZW91dCggZGVsaXZlciwgMCApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFB1Ymxpc2hlcyB0aGUgbWVzc2FnZSwgcGFzc2luZyB0aGUgZGF0YSB0byBpdCdzIHN1YnNjcmliZXJzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHB1Ymxpc2hcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHB1Ymxpc2hcbiAgICAgKiBAcGFyYW0ge30gZGF0YSBUaGUgZGF0YSB0byBwYXNzIHRvIHN1YnNjcmliZXJzXG4gICAgICogQHJldHVybiB7IEJvb2xlYW4gfVxuICAgICAqL1xuICAgIFB1YlN1Yi5wdWJsaXNoID0gZnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEgKXtcbiAgICAgICAgcmV0dXJuIHB1Ymxpc2goIG1lc3NhZ2UsIGRhdGEsIGZhbHNlLCBQdWJTdWIuaW1tZWRpYXRlRXhjZXB0aW9ucyApO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQdWJsaXNoZXMgdGhlIG1lc3NhZ2Ugc3luY2hyb25vdXNseSwgcGFzc2luZyB0aGUgZGF0YSB0byBpdCdzIHN1YnNjcmliZXJzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHB1Ymxpc2hTeW5jXG4gICAgICogQHBhcmFtIHsgU3RyaW5nIH0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwdWJsaXNoXG4gICAgICogQHBhcmFtIHt9IGRhdGEgVGhlIGRhdGEgdG8gcGFzcyB0byBzdWJzY3JpYmVyc1xuICAgICAqIEByZXR1cm4geyBCb29sZWFuIH1cbiAgICAgKi9cbiAgICBQdWJTdWIucHVibGlzaFN5bmMgPSBmdW5jdGlvbiggbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICByZXR1cm4gcHVibGlzaCggbWVzc2FnZSwgZGF0YSwgdHJ1ZSwgUHViU3ViLmltbWVkaWF0ZUV4Y2VwdGlvbnMgKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0aGUgcGFzc2VkIGZ1bmN0aW9uIHRvIHRoZSBwYXNzZWQgbWVzc2FnZS4gRXZlcnkgcmV0dXJuZWQgdG9rZW4gaXMgdW5pcXVlIGFuZCBzaG91bGQgYmUgc3RvcmVkIGlmIHlvdSBuZWVkIHRvIHVuc3Vic2NyaWJlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHN1YnNjcmliZVxuICAgICAqIEBwYXJhbSB7IFN0cmluZyB9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gc3Vic2NyaWJlIHRvXG4gICAgICogQHBhcmFtIHsgRnVuY3Rpb24gfSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYSBuZXcgbWVzc2FnZSBpcyBwdWJsaXNoZWRcbiAgICAgKiBAcmV0dXJuIHsgU3RyaW5nIH1cbiAgICAgKi9cbiAgICBQdWJTdWIuc3Vic2NyaWJlID0gZnVuY3Rpb24oIG1lc3NhZ2UsIGZ1bmMgKXtcbiAgICAgICAgaWYgKCB0eXBlb2YgZnVuYyAhPT0gJ2Z1bmN0aW9uJyl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBtZXNzYWdlID0gKHR5cGVvZiBtZXNzYWdlID09PSAnc3ltYm9sJykgPyBtZXNzYWdlLnRvU3RyaW5nKCkgOiBtZXNzYWdlO1xuXG4gICAgICAgIC8vIG1lc3NhZ2UgaXMgbm90IHJlZ2lzdGVyZWQgeWV0XG4gICAgICAgIGlmICggIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCggbWVzc2FnZXMsIG1lc3NhZ2UgKSApe1xuICAgICAgICAgICAgbWVzc2FnZXNbbWVzc2FnZV0gPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZvcmNpbmcgdG9rZW4gYXMgU3RyaW5nLCB0byBhbGxvdyBmb3IgZnV0dXJlIGV4cGFuc2lvbnMgd2l0aG91dCBicmVha2luZyB1c2FnZVxuICAgICAgICAvLyBhbmQgYWxsb3cgZm9yIGVhc3kgdXNlIGFzIGtleSBuYW1lcyBmb3IgdGhlICdtZXNzYWdlcycgb2JqZWN0XG4gICAgICAgIHZhciB0b2tlbiA9ICd1aWRfJyArIFN0cmluZygrK2xhc3RVaWQpO1xuICAgICAgICBtZXNzYWdlc1ttZXNzYWdlXVt0b2tlbl0gPSBmdW5jO1xuXG4gICAgICAgIC8vIHJldHVybiB0b2tlbiBmb3IgdW5zdWJzY3JpYmluZ1xuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgfTtcblxuICAgIFB1YlN1Yi5zdWJzY3JpYmVBbGwgPSBmdW5jdGlvbiggZnVuYyApe1xuICAgICAgICByZXR1cm4gUHViU3ViLnN1YnNjcmliZShBTExfU1VCU0NSSUJJTkdfTVNHLCBmdW5jKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0aGUgcGFzc2VkIGZ1bmN0aW9uIHRvIHRoZSBwYXNzZWQgbWVzc2FnZSBvbmNlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHN1YnNjcmliZU9uY2VcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHN1YnNjcmliZSB0b1xuICAgICAqIEBwYXJhbSB7IEZ1bmN0aW9uIH0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgbmV3IG1lc3NhZ2UgaXMgcHVibGlzaGVkXG4gICAgICogQHJldHVybiB7IFB1YlN1YiB9XG4gICAgICovXG4gICAgUHViU3ViLnN1YnNjcmliZU9uY2UgPSBmdW5jdGlvbiggbWVzc2FnZSwgZnVuYyApe1xuICAgICAgICB2YXIgdG9rZW4gPSBQdWJTdWIuc3Vic2NyaWJlKCBtZXNzYWdlLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gYmVmb3JlIGZ1bmMgYXBwbHksIHVuc3Vic2NyaWJlIG1lc3NhZ2VcbiAgICAgICAgICAgIFB1YlN1Yi51bnN1YnNjcmliZSggdG9rZW4gKTtcbiAgICAgICAgICAgIGZ1bmMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFB1YlN1YjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGFsbCBzdWJzY3JpcHRpb25zXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhbGlhcyBjbGVhckFsbFN1YnNjcmlwdGlvbnNcbiAgICAgKi9cbiAgICBQdWJTdWIuY2xlYXJBbGxTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY2xlYXJBbGxTdWJzY3JpcHRpb25zKCl7XG4gICAgICAgIG1lc3NhZ2VzID0ge307XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsZWFyIHN1YnNjcmlwdGlvbnMgYnkgdGhlIHRvcGljXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhbGlhcyBjbGVhckFsbFN1YnNjcmlwdGlvbnNcbiAgICAgKiBAcmV0dXJuIHsgaW50IH1cbiAgICAgKi9cbiAgICBQdWJTdWIuY2xlYXJTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY2xlYXJTdWJzY3JpcHRpb25zKHRvcGljKXtcbiAgICAgICAgdmFyIG07XG4gICAgICAgIGZvciAobSBpbiBtZXNzYWdlcyl7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1lc3NhZ2VzLCBtKSAmJiBtLmluZGV4T2YodG9waWMpID09PSAwKXtcbiAgICAgICAgICAgICAgICBkZWxldGUgbWVzc2FnZXNbbV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICAgQ291bnQgc3Vic2NyaXB0aW9ucyBieSB0aGUgdG9waWNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIGNvdW50U3Vic2NyaXB0aW9uc1xuICAgICAqIEByZXR1cm4geyBBcnJheSB9XG4gICAgKi9cbiAgICBQdWJTdWIuY291bnRTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY291bnRTdWJzY3JpcHRpb25zKHRvcGljKXtcbiAgICAgICAgdmFyIG07XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICB2YXIgdG9rZW47XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIGZvciAobSBpbiBtZXNzYWdlcykge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodG9rZW4gaW4gbWVzc2FnZXNbbV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAgIEdldHMgc3Vic2NyaXB0aW9ucyBieSB0aGUgdG9waWNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIGdldFN1YnNjcmlwdGlvbnNcbiAgICAqL1xuICAgIFB1YlN1Yi5nZXRTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gZ2V0U3Vic2NyaXB0aW9ucyh0b3BpYyl7XG4gICAgICAgIHZhciBtO1xuICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICBmb3IgKG0gaW4gbWVzc2FnZXMpe1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCl7XG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHN1YnNjcmlwdGlvbnNcbiAgICAgKlxuICAgICAqIC0gV2hlbiBwYXNzZWQgYSB0b2tlbiwgcmVtb3ZlcyBhIHNwZWNpZmljIHN1YnNjcmlwdGlvbi5cbiAgICAgKlxuXHQgKiAtIFdoZW4gcGFzc2VkIGEgZnVuY3Rpb24sIHJlbW92ZXMgYWxsIHN1YnNjcmlwdGlvbnMgZm9yIHRoYXQgZnVuY3Rpb25cbiAgICAgKlxuXHQgKiAtIFdoZW4gcGFzc2VkIGEgdG9waWMsIHJlbW92ZXMgYWxsIHN1YnNjcmlwdGlvbnMgZm9yIHRoYXQgdG9waWMgKGhpZXJhcmNoeSlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIHN1YnNjcmliZU9uY2VcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfCBGdW5jdGlvbiB9IHZhbHVlIEEgdG9rZW4sIGZ1bmN0aW9uIG9yIHRvcGljIHRvIHVuc3Vic2NyaWJlIGZyb21cbiAgICAgKiBAZXhhbXBsZSAvLyBVbnN1YnNjcmliaW5nIHdpdGggYSB0b2tlblxuICAgICAqIHZhciB0b2tlbiA9IFB1YlN1Yi5zdWJzY3JpYmUoJ215dG9waWMnLCBteUZ1bmMpO1xuICAgICAqIFB1YlN1Yi51bnN1YnNjcmliZSh0b2tlbik7XG4gICAgICogQGV4YW1wbGUgLy8gVW5zdWJzY3JpYmluZyB3aXRoIGEgZnVuY3Rpb25cbiAgICAgKiBQdWJTdWIudW5zdWJzY3JpYmUobXlGdW5jKTtcbiAgICAgKiBAZXhhbXBsZSAvLyBVbnN1YnNjcmliaW5nIGZyb20gYSB0b3BpY1xuICAgICAqIFB1YlN1Yi51bnN1YnNjcmliZSgnbXl0b3BpYycpO1xuICAgICAqL1xuICAgIFB1YlN1Yi51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdmFyIGRlc2NlbmRhbnRUb3BpY0V4aXN0cyA9IGZ1bmN0aW9uKHRvcGljKSB7XG4gICAgICAgICAgICAgICAgdmFyIG07XG4gICAgICAgICAgICAgICAgZm9yICggbSBpbiBtZXNzYWdlcyApe1xuICAgICAgICAgICAgICAgICAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBkZXNjZW5kYW50IG9mIHRoZSB0b3BpYyBleGlzdHM6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc1RvcGljICAgID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgdmFsdWUpIHx8IGRlc2NlbmRhbnRUb3BpY0V4aXN0cyh2YWx1ZSkgKSxcbiAgICAgICAgICAgIGlzVG9rZW4gICAgPSAhaXNUb3BpYyAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnLFxuICAgICAgICAgICAgaXNGdW5jdGlvbiA9IHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyxcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlLFxuICAgICAgICAgICAgbSwgbWVzc2FnZSwgdDtcblxuICAgICAgICBpZiAoaXNUb3BpYyl7XG4gICAgICAgICAgICBQdWJTdWIuY2xlYXJTdWJzY3JpcHRpb25zKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoIG0gaW4gbWVzc2FnZXMgKXtcbiAgICAgICAgICAgIGlmICggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCBtZXNzYWdlcywgbSApICl7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzW21dO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBpc1Rva2VuICYmIG1lc3NhZ2VbdmFsdWVdICl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZXNzYWdlW3ZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRva2VucyBhcmUgdW5pcXVlLCBzbyB3ZSBjYW4ganVzdCBzdG9wIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICggdCBpbiBtZXNzYWdlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1lc3NhZ2UsIHQpICYmIG1lc3NhZ2VbdF0gPT09IHZhbHVlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgbWVzc2FnZVt0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xufSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db25kaXRpb25hbC8uLi9ub2RlX21vZHVsZXMvLnBucG0vcHVic3ViLWpzQDEuOS40L25vZGVfbW9kdWxlcy9wdWJzdWItanMvc3JjL3B1YnN1Yi5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4vc3JjL0NvbnRyb2xGbG93L0NvbmRpdGlvbmFsLmZseWRlLnRzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwuZmx5ZGUudHMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLkNvbmRpdGlvbmFsID0gZXhwb3J0cy5Db25kaXRpb25UeXBlID0gdm9pZCAwO1xudmFyIENvbmRpdGlvblR5cGU7XG4oZnVuY3Rpb24gKENvbmRpdGlvblR5cGUpIHtcbiAgICBDb25kaXRpb25UeXBlW1wiRXF1YWxcIl0gPSBcIkVRVUFMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIk5vdEVxdWFsXCJdID0gXCJOT1RfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiR3JlYXRlclRoYW5cIl0gPSBcIkdSRUFURVJfVEhBTlwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJHcmVhdGVyVGhhbk9yRXF1YWxcIl0gPSBcIkdSRUFURVJfVEhBTl9PUl9FUVVBTFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJMZXNzVGhhblwiXSA9IFwiTEVTU19USEFOXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkxlc3NUaGFuT3JFcXVhbFwiXSA9IFwiTEVTU19USEFOX09SX0VRVUFMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkNvbnRhaW5zXCJdID0gXCJDT05UQUlOU1wiO1xuICAgIENvbmRpdGlvblR5cGVbXCJOb3RDb250YWluc1wiXSA9IFwiTk9UX0NPTlRBSU5TXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIlJlZ2V4TWF0Y2hlc1wiXSA9IFwiUkVHRVhfTUFUQ0hFU1wiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc0VtcHR5XCJdID0gXCJJU19FTVBUWVwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc05vdEVtcHR5XCJdID0gXCJJU19OT1RfRU1QVFlcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiSXNOdWxsXCJdID0gXCJJU19OVUxMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIklzTm90TnVsbFwiXSA9IFwiSVNfTk9UX05VTExcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiSXNVbmRlZmluZWRcIl0gPSBcIklTX1VOREVGSU5FRFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc05vdFVuZGVmaW5lZFwiXSA9IFwiSVNfTk9UX1VOREVGSU5FRFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJIYXNQcm9wZXJ0eVwiXSA9IFwiSEFTX1BST1BFUlRZXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkxlbmd0aEVxdWFsXCJdID0gXCJMRU5HVEhfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoTm90RXF1YWxcIl0gPSBcIkxFTkdUSF9OT1RfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoR3JlYXRlclRoYW5cIl0gPSBcIkxFTkdUSF9HUkVBVEVSX1RIQU5cIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoTGVzc1RoYW5cIl0gPSBcIkxFTkdUSF9MRVNTX1RIQU5cIjtcbiAgICBDb25kaXRpb25UeXBlW1wiVHlwZUVxdWFsc1wiXSA9IFwiVFlQRV9FUVVBTFNcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiRXhwcmVzc2lvblwiXSA9IFwiRVhQUkVTU0lPTlwiO1xufSkoQ29uZGl0aW9uVHlwZSA9IGV4cG9ydHMuQ29uZGl0aW9uVHlwZSB8fCAoZXhwb3J0cy5Db25kaXRpb25UeXBlID0ge30pKTtcbmZ1bmN0aW9uIGNvbmRpdGlvbmFsQ29uZmlnVG9EaXNwbGF5TmFtZShjb25maWcpIHtcbiAgICBjb25zdCB7IHR5cGUgfSA9IGNvbmZpZy5jb25kaXRpb247XG4gICAgY29uc3QgY29tcGFyZVRvID0gY29uZmlnLmNvbXBhcmVUby5tb2RlID09PSBcInN0YXRpY1wiXG4gICAgICAgID8gSlNPTi5zdHJpbmdpZnkoY29uZmlnLmNvbXBhcmVUby52YWx1ZSlcbiAgICAgICAgOiBcImBjb21wYXJlVG9gXCI7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5FcXVhbDpcbiAgICAgICAgICAgIHJldHVybiBgRXF1YWxzICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Ob3RFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiBgRG9lcyBub3QgZXF1YWwgJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkdyZWF0ZXJUaGFuOlxuICAgICAgICAgICAgcmV0dXJuIGBHcmVhdGVyIHRoYW4gJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkdyZWF0ZXJUaGFuT3JFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiBgR3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZXNzVGhhbjpcbiAgICAgICAgICAgIHJldHVybiBgTGVzcyB0aGFuICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZXNzVGhhbk9yRXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYExlc3MgdGhhbiBvciBlcXVhbCB0byAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuQ29udGFpbnM6XG4gICAgICAgICAgICByZXR1cm4gYENvbnRhaW5zICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Ob3RDb250YWluczpcbiAgICAgICAgICAgIHJldHVybiBgRG9lcyBub3QgY29udGFpbiAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuUmVnZXhNYXRjaGVzOlxuICAgICAgICAgICAgcmV0dXJuIGBNYXRjaGVzIHJlZ2V4ICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc0VtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIGBJcyBlbXB0eWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc05vdEVtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIGBJcyBub3QgZW1wdHlgO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNOdWxsOlxuICAgICAgICAgICAgcmV0dXJuIGBJcyBudWxsYDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTm90TnVsbDpcbiAgICAgICAgICAgIHJldHVybiBgSXMgbm90IG51bGxgO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNVbmRlZmluZWQ6XG4gICAgICAgICAgICByZXR1cm4gYElzIHVuZGVmaW5lZGA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc05vdFVuZGVmaW5lZDpcbiAgICAgICAgICAgIHJldHVybiBgSXMgbm90IHVuZGVmaW5lZGA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5IYXNQcm9wZXJ0eTpcbiAgICAgICAgICAgIHJldHVybiBgSGFzIHByb3BlcnR5ICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZW5ndGhFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiBgTGVuZ3RoIGVxdWFscyAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoTm90RXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYExlbmd0aCBkb2VzIG5vdCBlcXVhbCAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoR3JlYXRlclRoYW46XG4gICAgICAgICAgICByZXR1cm4gYExlbmd0aCBncmVhdGVyIHRoYW4gJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlbmd0aExlc3NUaGFuOlxuICAgICAgICAgICAgcmV0dXJuIGBMZW5ndGggbGVzcyB0aGFuICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5UeXBlRXF1YWxzOlxuICAgICAgICAgICAgcmV0dXJuIGBUeXBlIGVxdWFscyAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuRXhwcmVzc2lvbjpcbiAgICAgICAgICAgIHJldHVybiBjb25maWcuY29uZGl0aW9uLmRhdGE7XG4gICAgfVxufVxuZXhwb3J0cy5Db25kaXRpb25hbCA9IHtcbiAgICBpZDogXCJDb25kaXRpb25hbFwiLFxuICAgIG5hbWVzcGFjZTogXCJDb250cm9sIEZsb3dcIixcbiAgICBkZXNjcmlwdGlvbjogXCJFdmFsdWF0ZXMgYSBjb25kaXRpb24gYW5kIGVtaXRzIHRoZSB2YWx1ZSBvZiB0aGUgbWF0Y2hpbmcgY2FzZVwiLFxuICAgIGRlZmF1bHRTdHlsZToge1xuICAgICAgICBpY29uOiBcImNpcmNsZS1xdWVzdGlvblwiLFxuICAgIH0sXG4gICAgcnVuRm5CdWlsZGVyOiAoY29uZmlnKSA9PiB7XG4gICAgICAgIHJldHVybiAoaW5wdXRzLCBvdXRwdXRzLCBhZHYpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgY29tcGFyZVRvOiBhcmdUeXBlLCBwcm9wZXJ0eVBhdGgsIGNvbmRpdGlvbiwgdHJ1ZVZhbHVlLCBmYWxzZVZhbHVlLCB9ID0gY29uZmlnO1xuICAgICAgICAgICAgY29uc3QgeyB0cnVlOiB0cnVlT3V0cHV0LCBmYWxzZTogZmFsc2VPdXRwdXQgfSA9IG91dHB1dHM7XG4gICAgICAgICAgICBjb25zdCBjb21wYXJlZFZhbHVlID0gYXJnVHlwZS5tb2RlID09PSBcInN0YXRpY1wiID8gYXJnVHlwZS52YWx1ZSA6IGlucHV0cy5jb21wYXJlVG87XG4gICAgICAgICAgICBjb25zdCBsZWZ0U2lkZSA9IHByb3BlcnR5UGF0aFxuICAgICAgICAgICAgICAgID8gZ2V0UHJvcGVydHkoaW5wdXRzLnZhbHVlLCBwcm9wZXJ0eVBhdGgpXG4gICAgICAgICAgICAgICAgOiBpbnB1dHMudmFsdWU7XG4gICAgICAgICAgICBjb25zdCByaWdodFNpZGUgPSBjb25maWcuY29tcGFyZVRvLm1vZGUgPT09IFwiZHluYW1pY1wiICYmIGNvbmZpZy5jb21wYXJlVG8ucHJvcGVydHlQYXRoXG4gICAgICAgICAgICAgICAgPyBnZXRQcm9wZXJ0eShjb21wYXJlZFZhbHVlLCBjb25maWcuY29tcGFyZVRvLnByb3BlcnR5UGF0aClcbiAgICAgICAgICAgICAgICA6IGNvbXBhcmVkVmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjYWxjdWxhdGVDb25kaXRpb24obGVmdFNpZGUsIHJpZ2h0U2lkZSwgY29uZGl0aW9uKTtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dFRvVXNlID0gcmVzdWx0ID8gdHJ1ZU91dHB1dCA6IGZhbHNlT3V0cHV0O1xuICAgICAgICAgICAgY29uc3QgY29uZmlnVG9Vc2UgPSByZXN1bHQgPyB0cnVlVmFsdWUgOiBmYWxzZVZhbHVlO1xuICAgICAgICAgICAgaWYgKGNvbmZpZ1RvVXNlLnR5cGUgPT09IFwidmFsdWVcIikge1xuICAgICAgICAgICAgICAgIG91dHB1dFRvVXNlLm5leHQoaW5wdXRzLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbmZpZ1RvVXNlLnR5cGUgPT09IFwiY29tcGFyZVRvXCIpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRUb1VzZS5uZXh0KGNvbXBhcmVkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29uZmlnVG9Vc2UudHlwZSA9PT0gXCJleHByZXNzaW9uXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleHByZXNzaW9uID0gY29uZmlnVG9Vc2UuZGF0YTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmblN0ciA9IGAodmFsdWUsIGNvbXBhcmVUbykgPT4gJHtleHByZXNzaW9ufWA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZuID0gZXZhbChmblN0cik7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFRvVXNlLm5leHQoZm4oaW5wdXRzLnZhbHVlLCBjb21wYXJlZFZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkdi5vbkVycm9yKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0eXBlICR7Y29uZmlnVG9Vc2UudHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGRlZmluaXRpb25CdWlsZGVyOiAoY29uZmlnKSA9PiB7XG4gICAgICAgIGNvbnN0IGlucHV0cyA9IFtcInZhbHVlXCJdO1xuICAgICAgICBpZiAoY29uZmlnLmNvbXBhcmVUby5tb2RlID09PSBcImR5bmFtaWNcIikge1xuICAgICAgICAgICAgaW5wdXRzLnB1c2goXCJjb21wYXJlVG9cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3V0cHV0cyA9IHtcbiAgICAgICAgICAgIHRydWU6IHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWl0cyB0aGUgdmFsdWUgaWYgdGhlIGNvbmRpdGlvbiBpcyB0cnVlXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFsc2U6IHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWl0cyB0aGUgdmFsdWUgaWYgdGhlIGNvbmRpdGlvbiBpcyBmYWxzZVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBjb25kaXRpb25hbENvbmZpZ1RvRGlzcGxheU5hbWUoY29uZmlnKSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkV2YWx1YXRlcyBhIGNvbmRpdGlvbiBhbmQgZW1pdHMgdGhlIHZhbHVlIG9mIHRoZSBtYXRjaGluZyBjYXNlXCIsXG4gICAgICAgICAgICBpbnB1dHM6IE9iamVjdC5mcm9tRW50cmllcyhpbnB1dHMubWFwKChpbnB1dCkgPT4gW2lucHV0LCB7fV0pKSxcbiAgICAgICAgICAgIG91dHB1dHMsXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBkZWZhdWx0RGF0YToge1xuICAgICAgICBjb21wYXJlVG86IHsgbW9kZTogXCJkeW5hbWljXCIsIHByb3BlcnR5UGF0aDogXCJcIiB9LFxuICAgICAgICBwcm9wZXJ0eVBhdGg6IFwiXCIsXG4gICAgICAgIGNvbmRpdGlvbjoge1xuICAgICAgICAgICAgdHlwZTogQ29uZGl0aW9uVHlwZS5FcXVhbCxcbiAgICAgICAgfSxcbiAgICAgICAgdHJ1ZVZhbHVlOiB7XG4gICAgICAgICAgICB0eXBlOiBcInZhbHVlXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGZhbHNlVmFsdWU6IHtcbiAgICAgICAgICAgIHR5cGU6IFwidmFsdWVcIixcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIGVkaXRvckNvbmZpZzoge1xuICAgICAgICB0eXBlOiBcImN1c3RvbVwiLFxuICAgICAgICBlZGl0b3JDb21wb25lbnRCdW5kbGVQYXRoOiBcIi4uLy4uLy4uL2Rpc3QvdWkvQ29uZGl0aW9uYWwuanNcIixcbiAgICB9LFxufTtcbmZ1bmN0aW9uIGNhbGN1bGF0ZUNvbmRpdGlvbih2YWwxLCB2YWwyLCBjb25kaXRpb24pIHtcbiAgICBzd2l0Y2ggKGNvbmRpdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5FcXVhbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxID09PSB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTm90RXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gdmFsMSAhPT0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkdyZWF0ZXJUaGFuOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgPiB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuR3JlYXRlclRoYW5PckVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgPj0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlc3NUaGFuOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgPCB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVzc1RoYW5PckVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgPD0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkNvbnRhaW5zOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEuaW5jbHVkZXModmFsMik7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Ob3RDb250YWluczpcbiAgICAgICAgICAgIHJldHVybiAhdmFsMS5pbmNsdWRlcyh2YWwyKTtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzRW1wdHk6XG4gICAgICAgICAgICByZXR1cm4gdmFsMSA9PT0gXCJcIjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTm90RW1wdHk6XG4gICAgICAgICAgICByZXR1cm4gdmFsMSAhPT0gXCJcIjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTnVsbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxID09PSBudWxsO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNOb3ROdWxsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgIT09IG51bGw7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc1VuZGVmaW5lZDpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsMSA9PT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTm90VW5kZWZpbmVkOlxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWwxICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSGFzUHJvcGVydHk6XG4gICAgICAgICAgICByZXR1cm4gdmFsMS5oYXNPd25Qcm9wZXJ0eSh2YWwyKTtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlbmd0aEVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEubGVuZ3RoID09PSB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoTm90RXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gdmFsMS5sZW5ndGggIT09IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZW5ndGhHcmVhdGVyVGhhbjpcbiAgICAgICAgICAgIHJldHVybiB2YWwxLmxlbmd0aCA+IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZW5ndGhMZXNzVGhhbjpcbiAgICAgICAgICAgIHJldHVybiB2YWwxLmxlbmd0aCA8IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5UeXBlRXF1YWxzOlxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWwxID09PSB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuUmVnZXhNYXRjaGVzOiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cCh2YWwxKS50ZXN0KHZhbDIpO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5FeHByZXNzaW9uOiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZuU3RyID0gYCh2YWx1ZSwgY29tcGFyZVRvKSA9PiAke2NvbmRpdGlvbi5kYXRhfWA7XG4gICAgICAgICAgICAgICAgY29uc3QgZm4gPSBldmFsKGZuU3RyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4odmFsMSwgdmFsMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0UHJvcGVydHkob2JqLCBwYXRoKSB7XG4gICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KFwiLlwiKS5maWx0ZXIoKHApID0+IHAgIT09IFwiXCIpO1xuICAgIGxldCBjdXJyID0gb2JqO1xuICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xuICAgICAgICBpZiAocGFydCkge1xuICAgICAgICB9XG4gICAgICAgIGN1cnIgPSBjdXJyW3BhcnRdO1xuICAgIH1cbiAgICByZXR1cm4gY3Vycjtcbn1cblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fQ29uZGl0aW9uYWwvLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwuZmx5ZGUudHM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9Db250cm9sRmxvdy9Db25kaXRpb25hbC50c3giOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwudHN4ICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgQ29udHJvbEZsb3dfZmx5ZGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vQ29udHJvbEZsb3cuZmx5ZGUgKi8gXCIuL3NyYy9Db250cm9sRmxvdy9Db250cm9sRmxvdy5mbHlkZS50c1wiKTtcbmNvbnN0IHJlYWN0XzEgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCJyZWFjdFwiKSk7XG5jb25zdCBTaW1wbGVKc29uRWRpdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9saWIvU2ltcGxlSnNvbkVkaXRvciAqLyBcIi4vc3JjL2xpYi9TaW1wbGVKc29uRWRpdG9yLnRzeFwiKTtcbmNvbnN0IGNvbmRpdGlvbkVudW1Ub0xhYmVsID0ge1xuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuRXF1YWxdOiBcIkVxdWFsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Ob3RFcXVhbF06IFwiTm90IEVxdWFsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5HcmVhdGVyVGhhbl06IFwiR3JlYXRlciBUaGFuXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5HcmVhdGVyVGhhbk9yRXF1YWxdOiBcIkdyZWF0ZXIgVGhhbiBPciBFcXVhbFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTGVzc1RoYW5dOiBcIkxlc3MgVGhhblwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTGVzc1RoYW5PckVxdWFsXTogXCJMZXNzIFRoYW4gT3IgRXF1YWxcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkV4cHJlc3Npb25dOiBcIkpTIEV4cHJlc3Npb25cIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLlJlZ2V4TWF0Y2hlc106IFwiUmVnZXggTWF0Y2hlc1wiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuQ29udGFpbnNdOiBcIkNvbnRhaW5zXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Ob3RDb250YWluc106IFwiTm90IENvbnRhaW5zXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Jc0VtcHR5XTogXCJJcyBFbXB0eVwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuSXNOb3RFbXB0eV06IFwiSXMgTm90IEVtcHR5XCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Jc051bGxdOiBcIklzIE51bGxcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLklzTm90TnVsbF06IFwiSXMgTm90IE51bGxcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLklzVW5kZWZpbmVkXTogXCJJcyBVbmRlZmluZWRcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLklzTm90VW5kZWZpbmVkXTogXCJJcyBOb3QgVW5kZWZpbmVkXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5IYXNQcm9wZXJ0eV06IFwiSGFzIFByb3BlcnR5XCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5MZW5ndGhFcXVhbF06IFwiTGVuZ3RoIEVxdWFsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5MZW5ndGhOb3RFcXVhbF06IFwiTGVuZ3RoIE5vdCBFcXVhbFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTGVuZ3RoR3JlYXRlclRoYW5dOiBcIkxlbmd0aCBHcmVhdGVyIFRoYW5cIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkxlbmd0aExlc3NUaGFuXTogXCJMZW5ndGggTGVzcyBUaGFuXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5UeXBlRXF1YWxzXTogXCJUeXBlIEVxdWFsc1wiLFxufTtcbmNvbnN0IENvbmRpdGlvbmFsRWRpdG9yID0gZnVuY3Rpb24gQ29uZGl0aW9uYWxFZGl0b3IocHJvcHMpIHtcbiAgICBjb25zdCB7IHZhbHVlLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgW3VzZVByb3BQYXRoVmFsdWUsIHNldFVzZVByb3BQYXRoVmFsdWVdID0gcmVhY3RfMS5kZWZhdWx0LnVzZVN0YXRlKHZhbHVlLnByb3BlcnR5UGF0aCAhPT0gXCJcIik7XG4gICAgY29uc3QgW3VzZVByb3BQYXRoQ29tcGFyZVRvLCBzZXRVc2VQcm9wUGF0aENvbXBhcmVUb10gPSByZWFjdF8xLmRlZmF1bHQudXNlU3RhdGUodmFsdWUuY29tcGFyZVRvLm1vZGUgPT09IFwiZHluYW1pY1wiICYmIHZhbHVlLmNvbXBhcmVUby5wcm9wZXJ0eVBhdGggIT09IFwiXCIpO1xuICAgIGNvbnN0IG1heWJlQ29tcGFyZVRvRWRpdG9yID0gKDAsIHJlYWN0XzEudXNlTWVtbykoKCkgPT4ge1xuICAgICAgICBpZiAodmFsdWUuY29tcGFyZVRvLm1vZGUgIT09IFwic3RhdGljXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAodmFsdWUuY29tcGFyZVRvLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJzdHJpbmdcIjoge1xuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJFeHBlY3RlZCB2YWx1ZVwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiB2YWx1ZS5jb21wYXJlVG8udmFsdWUsIG9uQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBcInN0YXRpY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pIH0pKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiRXhwZWN0ZWQgdmFsdWVcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuTnVtZXJpY0lucHV0LCB7IHZhbHVlOiB2YWx1ZS5jb21wYXJlVG8udmFsdWUsIG9uVmFsdWVDaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IFwic3RhdGljXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSB9KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcImpzb25cIjoge1xuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJFeHBlY3RlZCB2YWx1ZVwiLCBoZWxwZXJUZXh0OiBgQW55IEpTIGV4cHJlc3Npb24gaXMgdmFsaWQgaGVyZS4gWW91IG1heSB1c2UgXCJ2YWx1ZVwiIGFuZCBcImNvbXBhcmVUb1wiIHZhcmlhYmxlcyBpbiB5b3VyIGV4cHJlc3Npb24uYCB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChTaW1wbGVKc29uRWRpdG9yXzEuU2ltcGxlSnNvbkVkaXRvciwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLnZhbHVlLCBvbkNoYW5nZTogKHZhbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJzdGF0aWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwianNvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGxhYmVsOiBcIkV4cGVjdGVkIFZhbHVlXCIgfSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIFt2YWx1ZV0pO1xuICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQocmVhY3RfMS5kZWZhdWx0LkZyYWdtZW50LCBudWxsLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkNvbmRpdGlvbiBUeXBlXCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkhUTUxTZWxlY3QsIHsgZmlsbDogdHJ1ZSwgdmFsdWU6IHZhbHVlLmNvbmRpdGlvbi50eXBlLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBlLnRhcmdldC52YWx1ZSA9PT0gQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkV4cHJlc3Npb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwidmFsdWUgLyBjb21wYXJlVG8gPT09IDQyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9LCBPYmplY3QuZW50cmllcyhjb25kaXRpb25FbnVtVG9MYWJlbCkubWFwKChbdmFsdWUsIGxhYmVsXSkgPT4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsga2V5OiB2YWx1ZSwgdmFsdWU6IHZhbHVlIH0sIGxhYmVsKSkpKSksXG4gICAgICAgIHZhbHVlLmNvbmRpdGlvbi50eXBlID09PSBDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuRXhwcmVzc2lvbiAmJiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJDb25kaXRpb24gZXhwcmVzc2lvblwiLCBoZWxwZXJUZXh0OiBgQW55IEpTIGV4cHJlc3Npb24gaXMgdmFsaWQgaGVyZS4gWW91IG1heSB1c2UgXCJ2YWx1ZVwiIGFuZCBcImNvbXBhcmVUb1wiIHZhcmlhYmxlcyBpbiB5b3VyIGV4cHJlc3Npb24uYCB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLmNvbmRpdGlvbi5kYXRhLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9KSkpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRGl2aWRlciwgbnVsbCksXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiVmFsdWUgdG8gY29tcGFyZSBtb2RlOlwiLCBpbmxpbmU6IHRydWUgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5IVE1MU2VsZWN0LCB7IHZhbHVlOiB2YWx1ZS5jb21wYXJlVG8ubW9kZSwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb21wYXJlVG86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGUudGFyZ2V0LnZhbHVlID09PSBcInN0YXRpY1wiID8gXCJcIiA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGUudGFyZ2V0LnZhbHVlID09PSBcInN0YXRpY1wiID8gXCJzdHJpbmdcIiA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9LFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwic3RhdGljXCIgfSwgXCJTdGF0aWNcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJkeW5hbWljXCIgfSwgXCJEeW5hbWljICh2aWEgaW5wdXQpXCIpKSksXG4gICAgICAgIHZhbHVlLmNvbXBhcmVUby5tb2RlID09PSBcInN0YXRpY1wiICYmIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlIHRvIGNvbXBhcmUgdHlwZTpcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLnR5cGUsIG9uQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBcInN0YXRpY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGUudGFyZ2V0LnZhbHVlID09PSBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBlLnRhcmdldC52YWx1ZSA9PT0gXCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcInZhbHVlIC8gNDIgPiBjb21wYXJlVG9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJzdHJpbmdcIiB9LCBcIlN0cmluZ1wiKSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcIm51bWJlclwiIH0sIFwiTnVtYmVyXCIpLFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwiZXhwcmVzc2lvblwiIH0sIFwiSlMgRXhwcmVzc2lvblwiKSkpKSxcbiAgICAgICAgbWF5YmVDb21wYXJlVG9FZGl0b3IsXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5EaXZpZGVyLCBudWxsKSxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZSB0byBlbWl0IGlmIHRydWVcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyBmaWxsOiB0cnVlLCB2YWx1ZTogdmFsdWUudHJ1ZVZhbHVlLnR5cGUsIG9uQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHJ1ZVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGUudGFyZ2V0LnZhbHVlID09PSBcImV4cHJlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJ2YWx1ZSAvIGNvbXBhcmVUbyA9PT0gNDIgPyAneWVzJyA6ICdubydcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJ2YWx1ZVwiIH0sIFwiVmFsdWVcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJjb21wYXJlVG9cIiB9LCBcIkNvbXBhcmUgdG8gdmFsdWVcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJleHByZXNzaW9uXCIgfSwgXCJDdXN0b20gZXhwcmVzc2lvblwiKSkpLFxuICAgICAgICB2YWx1ZS50cnVlVmFsdWUudHlwZSA9PT0gXCJleHByZXNzaW9uXCIgJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiRXhwcmVzc2lvbiB0byB1c2UgaWYgdHJ1ZTpcIiwgaGVscGVyVGV4dDogXCJBbnkgSlMgZXhwcmVzc2lvbiBpcyB2YWxpZCBoZXJlLiBZb3UgbWF5IHVzZSAndmFsdWUnIGFuZCAnY29tcGFyZVRvJyB2YXJpYWJsZXMgaW4geW91ciBleHByZXNzaW9uLlwiIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSW5wdXRHcm91cCwgeyB2YWx1ZTogdmFsdWUudHJ1ZVZhbHVlLmRhdGEsIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRydWVWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZXhwcmVzc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSB9KSkpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlIHRvIGVtaXQgaWYgZmFsc2VcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyBmaWxsOiB0cnVlLCB2YWx1ZTogdmFsdWUuZmFsc2VWYWx1ZS50eXBlLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZS50YXJnZXQudmFsdWUgPT09IFwiZXhwcmVzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInZhbHVlIC8gY29tcGFyZVRvID09PSA0MiA/ICd5ZXMnIDogJ25vJ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSkgfSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcInZhbHVlXCIgfSwgXCJWYWx1ZVwiKSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcImNvbXBhcmVUb1wiIH0sIFwiQ29tcGFyZSB0byB2YWx1ZVwiKSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcImV4cHJlc3Npb25cIiB9LCBcIkN1c3RvbSBleHByZXNzaW9uXCIpKSksXG4gICAgICAgIHZhbHVlLmZhbHNlVmFsdWUudHlwZSA9PT0gXCJleHByZXNzaW9uXCIgJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiRXhwcmVzc2lvbiB0byB1c2UgaWYgZmFsc2U6XCIsIGhlbHBlclRleHQ6IFwiQW55IEpTIGV4cHJlc3Npb24gaXMgdmFsaWQgaGVyZS4gWW91IG1heSB1c2UgJ3ZhbHVlJyBhbmQgJ2NvbXBhcmVUbycgdmFyaWFibGVzIGluIHlvdXIgZXhwcmVzc2lvbi5cIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLmZhbHNlVmFsdWUuZGF0YSwgb25DaGFuZ2U6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZXhwcmVzc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSB9KSkpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRGl2aWRlciwgbnVsbCksXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgaGVscGVyVGV4dDogXCJJZiB0aGUgaW5wdXQgdmFsdWUgaXMgYW4gb2JqZWN0IG9yIGEgbGlzdCwgeW91IGNhbiBzcGVjaWZ5IGEgcGF0aCB0byB0aGUgcHJvcGVydHkgdGhhdCB0aGUgY29uZGl0aW9uIHdpbGwgYmUgYXBwbGllZCB0b1wiIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQ2hlY2tib3gsIHsgbGFiZWw6IFwiVXNlIHByb3BlcnR5IHBhdGggZm9yIGlucHV0IHZhbHVlXCIsIGNoZWNrZWQ6IHVzZVByb3BQYXRoVmFsdWUsIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBlLnRhcmdldC5jaGVja2VkO1xuICAgICAgICAgICAgICAgICAgICBzZXRVc2VQcm9wUGF0aFZhbHVlKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlQYXRoOiB2YWwgPyB2YWx1ZS5wcm9wZXJ0eVBhdGggOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IH0pKSxcbiAgICAgICAgdXNlUHJvcFBhdGhWYWx1ZSAmJiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJJbnB1dCB2YWx1ZSBwcm9wZXJ0eSBwYXRoXCIsIGhlbHBlclRleHQ6IFwiSWYgdGhlIGlucHV0IHZhbHVlIGlzIGFuIG9iamVjdCBvciBhIGxpc3QsIHlvdSBjYW4gc3BlY2lmeSBhIHBhdGggdG8gdGhlIHByb3BlcnR5IHRoYXQgdGhlIGNvbmRpdGlvbiB3aWxsIGJlIGFwcGxpZWQgdG9cIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLnByb3BlcnR5UGF0aCwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVBhdGg6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgIH0pIH0pKSksXG4gICAgICAgIHZhbHVlLmNvbXBhcmVUby5tb2RlID09PSBcImR5bmFtaWNcIiAmJiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQocmVhY3RfMS5kZWZhdWx0LkZyYWdtZW50LCBudWxsLFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkRpdmlkZXIsIG51bGwpLFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBoZWxwZXJUZXh0OiBcIklmIHRoZSBjb21wYXJlVG8gdmFsdWUgaXMgYW4gb2JqZWN0IG9yIGEgbGlzdCwgeW91IGNhbiBzcGVjaWZ5IGEgcGF0aCB0byB0aGUgcHJvcGVydHkgdGhhdCB0aGUgY29uZGl0aW9uIHdpbGwgYmUgYXBwbGllZCB0b1wiIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkNoZWNrYm94LCB7IGxhYmVsOiBcIlVzZSBwcm9wZXJ0eSBwYXRoIGZvciBjb21wYXJlVG8gdmFsdWVcIiwgY2hlY2tlZDogdXNlUHJvcFBhdGhDb21wYXJlVG8sIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFVzZVByb3BQYXRoQ29tcGFyZVRvKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IFwiZHluYW1pY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVBhdGg6IHZhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB2YWx1ZS5jb21wYXJlVG8ubW9kZSA9PT0gXCJkeW5hbWljXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHZhbHVlLmNvbXBhcmVUby5wcm9wZXJ0eVBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gfSkpKSksXG4gICAgICAgIHZhbHVlLmNvbXBhcmVUby5tb2RlID09PSBcImR5bmFtaWNcIiAmJiB1c2VQcm9wUGF0aENvbXBhcmVUbyAmJiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJDb21wYXJlIHRvIHZhbHVlIHByb3BlcnR5IHBhdGhcIiwgaGVscGVyVGV4dDogXCJJZiB0aGUgY29tcGFyZSB0byB2YWx1ZSBpcyBhbiBvYmplY3Qgb3IgYSBsaXN0LCB5b3UgY2FuIHNwZWNpZnkgYSBwYXRoIHRvIHRoZSBwcm9wZXJ0eSB0aGF0IHRoZSBjb25kaXRpb24gd2lsbCBiZSBhcHBsaWVkIHRvXCIgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiB2YWx1ZS5jb21wYXJlVG8ucHJvcGVydHlQYXRoLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJkeW5hbWljXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVBhdGg6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pIH0pKSkpKTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IENvbmRpdGlvbmFsRWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db25kaXRpb25hbC8uL3NyYy9Db250cm9sRmxvdy9Db25kaXRpb25hbC50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9Db250cm9sRmxvdy9Db250cm9sRmxvdy5mbHlkZS50cyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4vc3JjL0NvbnRyb2xGbG93L0NvbnRyb2xGbG93LmZseWRlLnRzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CmV2YWwoIlxudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX2V4cG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9fZXhwb3J0U3RhcikgfHwgZnVuY3Rpb24obSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpIF9fY3JlYXRlQmluZGluZyhleHBvcnRzLCBtLCBwKTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuRW1pdE9uVHJpZ2dlciA9IGV4cG9ydHMuQm9vbGVhblNwbGl0ID0gZXhwb3J0cy5TdWJzY3JpYmUgPSBleHBvcnRzLlB1Ymxpc2ggPSBleHBvcnRzLlJvdW5kUm9iaW4gPSBleHBvcnRzLkxpbWl0VGltZXMgPSB2b2lkIDA7XG5fX2V4cG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9Db25kaXRpb25hbC5mbHlkZSAqLyBcIi4vc3JjL0NvbnRyb2xGbG93L0NvbmRpdGlvbmFsLmZseWRlLnRzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL1N3aXRjaC5mbHlkZSAqLyBcIi4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC5mbHlkZS50c1wiKSwgZXhwb3J0cyk7XG5jb25zdCBQdWJTdWIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBwdWJzdWItanMgKi8gXCIuLi9ub2RlX21vZHVsZXMvLnBucG0vcHVic3ViLWpzQDEuOS40L25vZGVfbW9kdWxlcy9wdWJzdWItanMvc3JjL3B1YnN1Yi5qc1wiKTtcbmNvbnN0IG5hbWVzcGFjZSA9IFwiQ29udHJvbCBGbG93XCI7XG5leHBvcnRzLkxpbWl0VGltZXMgPSB7XG4gICAgaWQ6IFwiTGltaXQgVGltZXNcIixcbiAgICBuYW1lc3BhY2UsXG4gICAgZGVzY3JpcHRpb246IFwiSXRlbSB3aWxsIGJlIGVtaXR0ZWQgdW50aWwgdGhlIGxpbWl0IGlzIHJlYWNoZWRcIixcbiAgICBpbnB1dHM6IHtcbiAgICAgICAgaXRlbTogeyBtb2RlOiBcInJlcXVpcmVkXCIsIGRlc2NyaXB0aW9uOiBcIlRoZSBpdGVtIHRvIGVtaXRcIiB9LFxuICAgICAgICB0aW1lczoge1xuICAgICAgICAgICAgbW9kZTogXCJyZXF1aXJlZFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG51bWJlciBvZiB0aW1lcyB0byBlbWl0IHRoZSBpdGVtXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiB7IG1vZGU6IFwib3B0aW9uYWxcIiwgZGVzY3JpcHRpb246IFwiUmVzZXQgdGhlIGNvdW50ZXJcIiB9LFxuICAgIH0sXG4gICAgb3V0cHV0czogeyBvazoge30gfSxcbiAgICByZWFjdGl2ZUlucHV0czogW1wiaXRlbVwiLCBcInJlc2V0XCJdLFxuICAgIGNvbXBsZXRpb25PdXRwdXRzOiBbXSxcbiAgICBydW46IGZ1bmN0aW9uIChpbnB1dHMsIG91dHB1dHMsIGFkdikge1xuICAgICAgICAvLyBtYWdpYyBoZXJlXG4gICAgICAgIGNvbnN0IHsgc3RhdGUgfSA9IGFkdjtcbiAgICAgICAgY29uc3QgeyBpdGVtLCB0aW1lcywgcmVzZXQgfSA9IGlucHV0cztcbiAgICAgICAgY29uc3QgeyBvayB9ID0gb3V0cHV0cztcbiAgICAgICAgaWYgKHR5cGVvZiByZXNldCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgc3RhdGUuc2V0KFwidmFsXCIsIDApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjdXJyID0gc3RhdGUuZ2V0KFwidmFsXCIpIHx8IDA7XG4gICAgICAgIGN1cnIrKztcbiAgICAgICAgc3RhdGUuc2V0KFwidmFsXCIsIGN1cnIpO1xuICAgICAgICBpZiAoY3VyciA+PSB0aW1lcykge1xuICAgICAgICAgICAgYWR2Lm9uRXJyb3IobmV3IEVycm9yKGBMaW1pdCBvZiAke3RpbWVzfSByZWFjaGVkYCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb2submV4dChpdGVtKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuZXhwb3J0cy5Sb3VuZFJvYmluID0ge1xuICAgIGlkOiBcIlJvdW5kUm9iaW5cIixcbiAgICBkZWZhdWx0U3R5bGU6IHtcbiAgICAgICAgaWNvbjogXCJyb3RhdGVcIixcbiAgICB9LFxuICAgIGRpc3BsYXlOYW1lOiBcIlJvdW5kIFJvYmluXCIsXG4gICAgbmFtZXNwYWNlLFxuICAgIGRlZmF1bHREYXRhOiB7IGNvdW50OiAzIH0sXG4gICAgZGVmaW5pdGlvbkJ1aWxkZXI6ICh7IGNvdW50IH0pID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBgUm91bmQgUm9iaW4gJHtjb3VudH1gLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBJdGVtIHdpbGwgYmUgZW1pdHRlZCB0byBvbmUgb2YgdGhlICR7Y291bnR9IG91dHB1dHMgaW4gYSByb3VuZCByb2JpbiBmYXNoaW9uYCxcbiAgICAgICAgICAgIGlucHV0czogeyB2YWx1ZTogeyBtb2RlOiBcInJlcXVpcmVkXCIsIGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSB0byBlbWl0XCIgfSB9LFxuICAgICAgICAgICAgY29tcGxldGlvbk91dHB1dHM6IFtdLFxuICAgICAgICAgICAgcmVhY3RpdmVJbnB1dHM6IFtcInZhbHVlXCJdLFxuICAgICAgICAgICAgb3V0cHV0czogQXJyYXkuZnJvbSh7IGxlbmd0aDogY291bnQgfSkucmVkdWNlKChvYmosIF8sIGkpID0+ICh7XG4gICAgICAgICAgICAgICAgLi4ub2JqLFxuICAgICAgICAgICAgICAgIFtgciR7aSArIDF9YF06IHtcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBUaGUgJHtpICsgMX0gb3V0cHV0IGluIG9yZGVyIHRvIGVtaXQgdGhlIHZhbHVlIHJlY2VpdmVkLiBBZnRlciBlbWl0dGluZyBhIHZhbHVlLCBpdCBtb3ZlcyB0byBcInIkeyhpICsgMikgJSBjb3VudH1cIidzIHR1cm4uYCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSksIHt9KSxcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIHJ1bkZuQnVpbGRlcjogKHsgY291bnQgfSkgPT4ge1xuICAgICAgICByZXR1cm4gKGlucHV0cywgX291dHB1dHMsIGFkdikgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzdGF0ZSB9ID0gYWR2O1xuICAgICAgICAgICAgY29uc3Qgb3V0cHV0cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGNvdW50IH0pLm1hcCgoXywgaSkgPT4gX291dHB1dHNbYHIke2kgKyAxfWBdKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnIgPSBzdGF0ZS5nZXQoXCJjdXJyXCIpIHx8IDA7XG4gICAgICAgICAgICBjb25zdCBvID0gb3V0cHV0c1tjdXJyXTtcbiAgICAgICAgICAgIGNvbnN0IG5leHRDdXJyID0gKGN1cnIgKyAxKSAlIGNvdW50O1xuICAgICAgICAgICAgc3RhdGUuc2V0KFwiY3VyclwiLCBuZXh0Q3Vycik7XG4gICAgICAgICAgICBvLm5leHQoaW5wdXRzLml0ZW0pO1xuICAgICAgICB9O1xuICAgIH0sXG4gICAgZWRpdG9yQ29uZmlnOiB7XG4gICAgICAgIHR5cGU6IFwic3RydWN0dXJlZFwiLFxuICAgICAgICBmaWVsZHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29uZmlnS2V5OiBcImNvdW50XCIsXG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiQ291bnRcIixcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDMsXG4gICAgICAgICAgICAgICAgYWxsb3dEeW5hbWljOiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfSxcbn07XG5leHBvcnRzLlB1Ymxpc2ggPSB7XG4gICAgaWQ6IFwiUHVibGlzaFwiLFxuICAgIG5hbWVzcGFjZSxcbiAgICBkZXNjcmlwdGlvbjogXCJQdWJsaXNoZXMgYSB2YWx1ZSBieSBhIGtleSB0byBhbGwgbGlzdGVuZXJzIGluIHRoZSBjdXJyZW50IGZsb3cuIFVzZSAnU3Vic2NyaWJlJyB0byBsaXN0ZW4gdG8gZXZlbnRzLlwiLFxuICAgIGlucHV0czoge1xuICAgICAgICBrZXk6IHtcbiAgICAgICAgICAgIG1vZGU6IFwicmVxdWlyZWRcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkEga2V5IHRvIHVzZSB0byBzdWJzY3JpYmUgdG8gdmFsdWVzXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHZhbHVlOiB7IG1vZGU6IFwicmVxdWlyZWRcIiB9LFxuICAgIH0sXG4gICAgb3V0cHV0czoge30sXG4gICAgcnVuOiBmdW5jdGlvbiAoaW5wdXRzLCBfLCBhZHYpIHtcbiAgICAgICAgLy8gbWFnaWMgaGVyZVxuICAgICAgICBjb25zdCBuc0tleSA9IGAke2Fkdi5hbmNlc3RvcnNJbnNJZHN9X18ke2lucHV0cy5rZXl9YDtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2gobnNLZXksIGlucHV0cy52YWx1ZSk7XG4gICAgfSxcbn07XG5leHBvcnRzLlN1YnNjcmliZSA9IHtcbiAgICBpZDogXCJTdWJzY3JpYmVcIixcbiAgICBuYW1lc3BhY2UsXG4gICAgZGVzY3JpcHRpb246IFwiU3Vic2NyaWJlcyB0byBhIHZhbHVlIHB1Ymxpc2hlZCBieSBhIGtleS4gVXNlICdQdWJsaXNoJyB0byBwdWJsaXNoIHZhbHVlcy5cIixcbiAgICBpbnB1dHM6IHtcbiAgICAgICAga2V5OiB7XG4gICAgICAgICAgICBtb2RlOiBcInJlcXVpcmVkXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBIGtleSB0byB1c2UgdG8gc3Vic2NyaWJlIHRvIHZhbHVlc1wiLFxuICAgICAgICB9LFxuICAgICAgICBpbml0aWFsOiB7XG4gICAgICAgICAgICBtb2RlOiBcInJlcXVpcmVkLWlmLWNvbm5lY3RlZFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSWYgcGFzc2VkIHdpbGwgYmUgcHVibGlzaGVkIGhhcyB0aGUgZmlyc3QgdmFsdWVcIixcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIGNvbXBsZXRpb25PdXRwdXRzOiBbXSxcbiAgICBvdXRwdXRzOiB7IHZhbHVlOiB7IGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSBwdWJsaXNoZWQgYnkgdGhlIGtleVwiIH0gfSxcbiAgICBydW46IGZ1bmN0aW9uIChpbnB1dHMsIG91dHB1dHMsIGFkdikge1xuICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSBvdXRwdXRzO1xuICAgICAgICBjb25zdCBuc0tleSA9IGAke2Fkdi5hbmNlc3RvcnNJbnNJZHN9X18ke2lucHV0cy5rZXl9YDtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBQdWJTdWIuc3Vic2NyaWJlKG5zS2V5LCAoXywgZGF0YSkgPT4ge1xuICAgICAgICAgICAgdmFsdWUubmV4dChkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXRzLmluaXRpYWwgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHZhbHVlLm5leHQoaW5wdXRzLmluaXRpYWwpO1xuICAgICAgICB9XG4gICAgICAgIGFkdi5vbkNsZWFudXAoKCkgPT4ge1xuICAgICAgICAgICAgUHViU3ViLnVuc3Vic2NyaWJlKHRva2VuKTtcbiAgICAgICAgfSk7XG4gICAgfSxcbn07XG5leHBvcnRzLkJvb2xlYW5TcGxpdCA9IHtcbiAgICBuYW1lc3BhY2UsXG4gICAgaWQ6IFwiQm9vbGVhbiBTcGxpdFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlNwbGl0cyBhIGJvb2xlYW4gdmFsdWUgaW50byB0d28gb3V0cHV0c1wiLFxuICAgIGlucHV0czoge1xuICAgICAgICB2YWx1ZTogeyBtb2RlOiBcInJlcXVpcmVkXCIsIGRlc2NyaXB0aW9uOiBcIkJvb2xlYW4gdmFsdWVcIiB9LFxuICAgICAgICB0cnVlVmFsdWU6IHtcbiAgICAgICAgICAgIG1vZGU6IFwicmVxdWlyZWQtaWYtY29ubmVjdGVkXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJWYWx1ZSB0byBlbWl0IGlmIHRoZSBpbnB1dCBpcyB0cnVlLiBEZWZhdWx0cyB0byB0cnVlXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGZhbHNlVmFsdWU6IHtcbiAgICAgICAgICAgIG1vZGU6IFwicmVxdWlyZWQtaWYtY29ubmVjdGVkXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJWYWx1ZSB0byBlbWl0IGlmIHRoZSBpbnB1dCBpcyBmYWxzZS4gRGVmYXVsdHMgdG8gZmFsc2VcIixcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIG91dHB1dHM6IHtcbiAgICAgICAgdHJ1ZTogeyBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgaXMgdHJ1ZVwiIH0sXG4gICAgICAgIGZhbHNlOiB7IGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSBpcyBmYWxzZVwiIH0sXG4gICAgfSxcbiAgICBydW46IGZ1bmN0aW9uIChpbnB1dHMsIG91dHB1dHMpIHtcbiAgICAgICAgY29uc3QgeyB0cnVlOiB0cnVlT3V0cHV0LCBmYWxzZTogZmFsc2VPdXRwdXQgfSA9IG91dHB1dHM7XG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIHRydWVWYWx1ZSwgZmFsc2VWYWx1ZSB9ID0gaW5wdXRzO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRydWVPdXRwdXQubmV4dCh0cnVlVmFsdWUgIT09IG51bGwgJiYgdHJ1ZVZhbHVlICE9PSB2b2lkIDAgPyB0cnVlVmFsdWUgOiB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZhbHNlT3V0cHV0Lm5leHQoZmFsc2VWYWx1ZSAhPT0gbnVsbCAmJiBmYWxzZVZhbHVlICE9PSB2b2lkIDAgPyBmYWxzZVZhbHVlIDogZmFsc2UpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5leHBvcnRzLkVtaXRPblRyaWdnZXIgPSB7XG4gICAgbmFtZXNwYWNlLFxuICAgIGlkOiBcIkVtaXQgb24gVHJpZ2dlclwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkVtaXRzIHRoZSB2YWx1ZSB3aGVuIHRoZSB0cmlnZ2VyIGlucHV0IHJlY2VpdmVzIGFueSB2YWx1ZVwiLFxuICAgIGlucHV0czoge1xuICAgICAgICB2YWx1ZTogeyBtb2RlOiBcInJlcXVpcmVkXCIsIGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSB0byBlbWl0XCIgfSxcbiAgICAgICAgdHJpZ2dlcjogeyBtb2RlOiBcInJlcXVpcmVkXCIsIGRlc2NyaXB0aW9uOiBcIlRoZSB0cmlnZ2VyIHRvIGVtaXQgdGhlIHZhbHVlXCIgfSxcbiAgICB9LFxuICAgIG91dHB1dHM6IHtcbiAgICAgICAgcmVzdWx0OiB7IGRlc2NyaXB0aW9uOiBcIlRoZSB2YWx1ZSBlbWl0dGVkXCIgfSxcbiAgICB9LFxuICAgIHJ1bjogZnVuY3Rpb24gKGlucHV0cywgb3V0cHV0cykge1xuICAgICAgICBjb25zdCB7IHJlc3VsdCB9ID0gb3V0cHV0cztcbiAgICAgICAgY29uc3QgeyB2YWx1ZSwgdHJpZ2dlciB9ID0gaW5wdXRzO1xuICAgICAgICBpZiAodHJpZ2dlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXN1bHQubmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fQ29uZGl0aW9uYWwvLi9zcmMvQ29udHJvbEZsb3cvQ29udHJvbEZsb3cuZmx5ZGUudHM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9Db250cm9sRmxvdy9Td2l0Y2guZmx5ZGUudHMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLmZseWRlLnRzICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuU3dpdGNoID0gdm9pZCAwO1xuZXhwb3J0cy5Td2l0Y2ggPSB7XG4gICAgaWQ6IFwiU3dpdGNoXCIsXG4gICAgbmFtZXNwYWNlOiBcIkNvbnRyb2wgRmxvd1wiLFxuICAgIGRlZmF1bHRTdHlsZToge1xuICAgICAgICBpY29uOiBcInNpdGVtYXBcIixcbiAgICB9LFxuICAgIGRlc2NyaXB0aW9uOiBcIkFsbG93cyB5b3UgdG8gc3dpdGNoIGJldHdlZW4gbXVsdGlwbGUgb3V0cHV0cyBiYXNlZCBvbiB0aGUgdmFsdWUgb2Ygb25lIGlucHV0IG9yIG1vcmUsIHVzaW5nIGNvZGUgZXhwcmVzc2lvbnNcIixcbiAgICBydW5GbkJ1aWxkZXI6IChjb25maWcpID0+IHtcbiAgICAgICAgZnVuY3Rpb24gZXZhbEV4cHJlc3Npb24oZXhwcmVzc2lvbiwgaW5wdXRzKSB7XG4gICAgICAgICAgICByZXR1cm4gZXZhbChgKGlucHV0cykgPT4gKCR7ZXhwcmVzc2lvbn0pYCkoaW5wdXRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGlucHV0cywgb3V0cHV0cywgYWR2KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGRlZmF1bHRDYXNlLCBjYXNlczogY2FzZXMgfSA9IGNvbmZpZztcbiAgICAgICAgICAgIGxldCBmb3VuZENhc2UgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgeyBuYW1lLCBjb25kaXRpb25FeHByZXNzaW9uLCBvdXRwdXRFeHByZXNzaW9uIH0gb2YgY2FzZXMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSBldmFsRXhwcmVzc2lvbihjb25kaXRpb25FeHByZXNzaW9uLCBpbnB1dHMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh7IGNvbmRpdGlvbiwgY29uZGl0aW9uRXhwcmVzc2lvbiwgaW5wdXRzIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDQyNDIsIGNvbmRpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0c1tuYW1lXS5uZXh0KGV2YWxFeHByZXNzaW9uKG91dHB1dEV4cHJlc3Npb24sIGlucHV0cykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kQ2FzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkdi5vbkVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWR2Lm9uRXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFmb3VuZENhc2UgJiYgZGVmYXVsdENhc2UuZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIG91dHB1dHMuZGVmYXVsdC5uZXh0KGV2YWxFeHByZXNzaW9uKGRlZmF1bHRDYXNlLm91dHB1dEV4cHJlc3Npb24sIGlucHV0cykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZGVmaW5pdGlvbkJ1aWxkZXI6IChjb25maWcpID0+IHtcbiAgICAgICAgY29uc3QgeyBpbnB1dHMsIGNhc2VzOiBvdXRwdXRzLCBkZWZhdWx0Q2FzZSB9ID0gY29uZmlnO1xuICAgICAgICBjb25zdCBpbnB1dERlZnMgPSBpbnB1dHMubWFwKChuYW1lLCBpKSA9PiAoe1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgU3dpdGNoIGlucHV0IG5vLiAke2kgKyAxfWAsXG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3Qgb3V0cHV0RGVmcyA9IG91dHB1dHMubWFwKCh7IG5hbWUgfSwgaSkgPT4gKHtcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFN3aXRjaCBvdXRwdXQgbm8uICR7aSArIDF9YCxcbiAgICAgICAgfSkpO1xuICAgICAgICBpZiAoZGVmYXVsdENhc2UuZW5hYmxlZCkge1xuICAgICAgICAgICAgb3V0cHV0RGVmcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcImRlZmF1bHRcIixcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTd2l0Y2ggZGVmYXVsdCBjYXNlIG91dHB1dFwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlucHV0czogaW5wdXREZWZzLnJlZHVjZSgoYWNjLCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0pID0+IHtcbiAgICAgICAgICAgICAgICBhY2NbbmFtZV0gPSB7IGRlc2NyaXB0aW9uIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH0sIHt9KSxcbiAgICAgICAgICAgIG91dHB1dHM6IG91dHB1dERlZnMucmVkdWNlKChhY2MsIHsgbmFtZSwgZGVzY3JpcHRpb24gfSkgPT4ge1xuICAgICAgICAgICAgICAgIGFjY1tuYW1lXSA9IHsgZGVzY3JpcHRpb24gfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgfSwge30pLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IFwiU3dpdGNoXCIsXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBkZWZhdWx0RGF0YToge1xuICAgICAgICBpbnB1dHM6IFtcInZhbHVlXCJdLFxuICAgICAgICBjYXNlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiY2FzZTFcIixcbiAgICAgICAgICAgICAgICBjb25kaXRpb25FeHByZXNzaW9uOiBcIlwiLFxuICAgICAgICAgICAgICAgIG91dHB1dEV4cHJlc3Npb246IFwiaW5wdXRzLnZhbHVlXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBkZWZhdWx0Q2FzZToge1xuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgIG91dHB1dEV4cHJlc3Npb246IFwiaW5wdXQudmFsdWVcIixcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIGVkaXRvckNvbmZpZzoge1xuICAgICAgICB0eXBlOiBcImN1c3RvbVwiLFxuICAgICAgICBlZGl0b3JDb21wb25lbnRCdW5kbGVQYXRoOiBcIi4uLy4uLy4uL2Rpc3QvdWkvU3dpdGNoLmpzXCIsXG4gICAgfSxcbn07XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vX19NYWNyb05vZGVfX0NvbmRpdGlvbmFsLy4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC5mbHlkZS50cz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4vc3JjL2xpYi9TaW1wbGVKc29uRWRpdG9yLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9saWIvU2ltcGxlSnNvbkVkaXRvci50c3ggKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CmV2YWwoIlxudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcbn0pIDogZnVuY3Rpb24obywgdikge1xuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbn0pO1xudmFyIF9faW1wb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyKSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuU2ltcGxlSnNvbkVkaXRvciA9IHZvaWQgMDtcbmNvbnN0IGNvcmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBibHVlcHJpbnRqcy9jb3JlICovIFwiQGJsdWVwcmludGpzL2NvcmVcIik7XG5jb25zdCByZWFjdF8xID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIikpO1xuZnVuY3Rpb24gU2ltcGxlSnNvbkVkaXRvcihwcm9wcykge1xuICAgIGNvbnN0IFt0ZW1wRGF0YVZhbHVlLCBzZXRUZW1wRGF0YVZhbHVlXSA9IHJlYWN0XzEuZGVmYXVsdC51c2VTdGF0ZShKU09OLnN0cmluZ2lmeShwcm9wcy52YWx1ZSwgbnVsbCwgMikpO1xuICAgIGNvbnN0IFtkYXRhUGFyc2VFcnJvciwgc2V0RGF0YVBhcnNlRXJyb3JdID0gcmVhY3RfMS5kZWZhdWx0LnVzZVN0YXRlKCk7XG4gICAgY29uc3Qgb25WYWx1ZUNoYW5nZSA9ICgwLCByZWFjdF8xLnVzZUNhbGxiYWNrKSgoZSkgPT4ge1xuICAgICAgICBzZXRUZW1wRGF0YVZhbHVlKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIHNldERhdGFQYXJzZUVycm9yKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICBwcm9wcy5vbkNoYW5nZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgc2V0RGF0YVBhcnNlRXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH0sIFtwcm9wc10pO1xuICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogcHJvcHMubGFiZWwsIGludGVudDogZGF0YVBhcnNlRXJyb3IgPyBcImRhbmdlclwiIDogdW5kZWZpbmVkLCBoZWxwZXJUZXh0OiBkYXRhUGFyc2VFcnJvciB9LFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuVGV4dEFyZWEsIHsgdmFsdWU6IHRlbXBEYXRhVmFsdWUsIGZpbGw6IHRydWUsIG9uQ2hhbmdlOiBvblZhbHVlQ2hhbmdlIH0pKSk7XG59XG5leHBvcnRzLlNpbXBsZUpzb25FZGl0b3IgPSBTaW1wbGVKc29uRWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db25kaXRpb25hbC8uL3NyYy9saWIvU2ltcGxlSnNvbkVkaXRvci50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIkJsdWVwcmludCJdOwoKLyoqKi8gfSksCgovKioqLyAicmVhY3QiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJSZWFjdCIgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7CgoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJSZWFjdCJdOwoKLyoqKi8gfSkKCi8qKioqKiovIAl9KTsKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTsKLyoqKioqKi8gCQovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQl2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTsKLyoqKioqKi8gCQlpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHsKLyoqKioqKi8gCQkJcmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJCX0KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlpZDogbW9kdWxlSWQsCi8qKioqKiovIAkJCWxvYWRlZDogZmFsc2UsCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCV9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sb2FkZWQgPSB0cnVlOwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovIAkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCS8qIHdlYnBhY2svcnVudGltZS9ub2RlIG1vZHVsZSBkZWNvcmF0b3IgKi8KLyoqKioqKi8gCSgoKSA9PiB7Ci8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5ubWQgPSAobW9kdWxlKSA9PiB7Ci8qKioqKiovIAkJCW1vZHVsZS5wYXRocyA9IFtdOwovKioqKioqLyAJCQlpZiAoIW1vZHVsZS5jaGlsZHJlbikgbW9kdWxlLmNoaWxkcmVuID0gW107Ci8qKioqKiovIAkJCXJldHVybiBtb2R1bGU7Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCX0pKCk7Ci8qKioqKiovIAkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCQovKioqKioqLyAJLy8gc3RhcnR1cAovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAkvLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZAovKioqKioqLyAJdmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIuL3NyYy9Db250cm9sRmxvdy9Db25kaXRpb25hbC50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fQ29uZGl0aW9uYWwgPSBfX3dlYnBhY2tfZXhwb3J0c19fOwovKioqKioqLyAJCi8qKioqKiovIH0pKCkKOw==","InlineValue":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IHR5cGVzID0gW1xuICAgIFwic3RyaW5nXCIsXG4gICAgXCJudW1iZXJcIixcbiAgICBcImpzb25cIixcbiAgICBcImJvb2xlYW5cIixcbl07XG5jb25zdCBkZWZhdWx0VmFsdWVQZXJUeXBlID0ge1xuICAgIHN0cmluZzogKGN1cnJWYWx1ZSkgPT4gYCR7Y3VyclZhbHVlfWAsXG4gICAgbnVtYmVyOiAoY3VyclZhbHVlKSA9PiBpc05hTihOdW1iZXIoY3VyclZhbHVlKSkgPyAwIDogTnVtYmVyKGN1cnJWYWx1ZSksXG4gICAganNvbjogKGN1cnJWYWx1ZSkgPT4gSlNPTi5zdHJpbmdpZnkoY3VyclZhbHVlKSxcbiAgICBib29sZWFuOiAoY3VyclZhbHVlKSA9PiAhIWN1cnJWYWx1ZSxcbiAgICBleHByZXNzaW9uOiAoY3VyclZhbHVlKSA9PiBjdXJyVmFsdWUsXG59O1xuY29uc3QgbGFiZWxNYXhMZW5ndGggPSAyMDtcbmZ1bmN0aW9uIHZhbFRvTGFiZWwodmFsKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbGFiZWwgPSBKU09OLnN0cmluZ2lmeSh2YWwpO1xuICAgICAgICBpZiAobGFiZWwubGVuZ3RoID4gbGFiZWxNYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtsYWJlbC5zbGljZSgwLCBsYWJlbE1heExlbmd0aCl9Li4uYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBgVmFsdWVgO1xuICAgIH1cbn1cbmNvbnN0IElubGluZVZhbHVlRWRpdG9yID0gZnVuY3Rpb24gSW5saW5lVmFsdWVFZGl0b3IocHJvcHMpIHtcbiAgICBjb25zdCB7IHZhbHVlLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgY2hhbmdlVHlwZSA9ICgwLCByZWFjdF8xLnVzZUNhbGxiYWNrKSgodHlwZSkgPT4ge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGRlZmF1bHRWYWx1ZVBlclR5cGVbdHlwZV0odmFsdWUudmFsdWUpO1xuICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICB2YWx1ZTogbmV3VmFsdWUsXG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgbGFiZWw6IHZhbFRvTGFiZWwodmFsdWUudmFsdWUpID09PSB2YWx1ZS5sYWJlbFxuICAgICAgICAgICAgICAgID8gdmFsVG9MYWJlbChuZXdWYWx1ZSlcbiAgICAgICAgICAgICAgICA6IHZhbHVlLmxhYmVsLFxuICAgICAgICB9KTtcbiAgICB9LCBbdmFsdWUsIG9uQ2hhbmdlXSk7XG4gICAgY29uc3QgY2hhbmdlVmFsdWUgPSAoMCwgcmVhY3RfMS51c2VDYWxsYmFjaykoKF92YWwpID0+IHtcbiAgICAgICAgY29uc3QgbmV3TGFiZWwgPSB2YWxUb0xhYmVsKF92YWwpO1xuICAgICAgICBjb25zdCBvbGRMYWJlbCA9IHZhbFRvTGFiZWwodmFsdWUudmFsdWUpO1xuICAgICAgICBjb25zdCB3YXNVc2luZ0RlZmF1bHRMYWJlbCA9IHZhbHVlLmxhYmVsID09PSBvbGRMYWJlbCB8fCAhdmFsdWUubGFiZWw7XG4gICAgICAgIGNvbnN0IGxhYmVsVG9Vc2UgPSB3YXNVc2luZ0RlZmF1bHRMYWJlbCA/IG5ld0xhYmVsIDogdmFsdWUubGFiZWw7XG4gICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIHZhbHVlOiBfdmFsLCBsYWJlbDogbGFiZWxUb1VzZSB9KTtcbiAgICB9LCBbdmFsdWUsIG9uQ2hhbmdlXSk7XG4gICAgY29uc3QgZWRpdG9yUGFuZWwgPSAoMCwgcmVhY3RfMS51c2VNZW1vKSgoKSA9PiB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZTpcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSW5wdXRHcm91cCwgeyB0eXBlOiBcInRleHRcIiwgdmFsdWU6IHZhbHVlLnZhbHVlLCBvbkNoYW5nZTogKGUpID0+IGNoYW5nZVZhbHVlKGUudGFyZ2V0LnZhbHVlKSB9KSkpO1xuICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZTpcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuTnVtZXJpY0lucHV0LCB7IHZhbHVlOiB2YWx1ZS52YWx1ZSwgb25WYWx1ZUNoYW5nZTogKGUpID0+IGNoYW5nZVZhbHVlKGUpIH0pKSk7XG4gICAgICAgICAgICBjYXNlIFwianNvblwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZTpcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuVGV4dEFyZWEsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBvbkNoYW5nZTogKGUpID0+IGNoYW5nZVZhbHVlKGUudGFyZ2V0LnZhbHVlKSB9KSkpO1xuICAgICAgICAgICAgY2FzZSBcImJvb2xlYW5cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiVmFsdWU6XCIgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkhUTUxTZWxlY3QsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBvbkNoYW5nZTogKGUpID0+IGNoYW5nZVZhbHVlKGUudGFyZ2V0LnZhbHVlID09PSBcInRydWVcIikgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwidHJ1ZVwiIH0sIFwidHJ1ZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwiZmFsc2VcIiB9LCBcImZhbHNlXCIpKSkpO1xuICAgICAgICB9XG4gICAgfSwgW3ZhbHVlLCBjaGFuZ2VWYWx1ZV0pO1xuICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZSB0eXBlOlwiIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyB2YWx1ZTogdmFsdWUudHlwZSwgb25DaGFuZ2U6IChlKSA9PiBjaGFuZ2VUeXBlKGUudGFyZ2V0LnZhbHVlKSB9LCB0eXBlcy5tYXAoKHR5cGUpID0+IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IGtleTogdHlwZSwgdmFsdWU6IHR5cGUgfSwgdHlwZSkpKSkpLFxuICAgICAgICBlZGl0b3JQYW5lbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJMYWJlbDpcIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdHlwZTogXCJ0ZXh0XCIsIHZhbHVlOiB2YWx1ZS5sYWJlbCwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCBsYWJlbDogZS50YXJnZXQudmFsdWUgfSkgfSkpKSk7XG59O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBJbmxpbmVWYWx1ZUVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fSW5saW5lVmFsdWUvLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeD8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIkBibHVlcHJpbnRqcy9jb3JlIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogZXh0ZXJuYWwgIkJsdWVwcmludCIgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIkJsdWVwcmludCJdOwoKLyoqKi8gfSksCgovKioqLyAicmVhY3QiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJSZWFjdCIgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7Cgptb2R1bGUuZXhwb3J0cyA9IHdpbmRvd1siUmVhY3QiXTsKCi8qKiovIH0pCgovKioqKioqLyAJfSk7Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307Ci8qKioqKiovIAkKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJdmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07Ci8qKioqKiovIAkJaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7Ci8qKioqKiovIAkJCXJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmlkIG5lZWRlZAovKioqKioqLyAJCQkvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQlfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkKLyoqKioqKi8gCS8vIHN0YXJ0dXAKLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWQKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygiLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCIpOwovKioqKioqLyAJd2luZG93Ll9fTWFjcm9Ob2RlX19JbmxpbmVWYWx1ZSA9IF9fd2VicGFja19leHBvcnRzX187Ci8qKioqKiovIAkKLyoqKioqKi8gfSkoKQo7","Switch":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuY29uc3QgcmVhY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIik7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMiA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IE1BWF9DQVNFUyA9IDY7XG5jb25zdCBTd2l0Y2hFZGl0b3IgPSBmdW5jdGlvbiBTd2l0Y2hFZGl0b3IocHJvcHMpIHtcbiAgICBjb25zdCB7IHZhbHVlLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgaW5wdXRzRWxlbSA9ICgwLCByZWFjdF8xLnVzZU1lbW8pKCgpID0+IHtcbiAgICAgICAgY29uc3QgaW5wdXRzID0gdmFsdWUuaW5wdXRzLm1hcCgoaW5wdXQsIGkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAocmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgSW5wdXQgbmFtZSBuby4gJHtpICsgMX06YCwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IGlucHV0LCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0lucHV0cyA9IFsuLi52YWx1ZS5pbnB1dHNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5wdXRzW2ldID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7IC4uLnZhbHVlLCBpbnB1dHM6IG5ld0lucHV0cyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgcmlnaHRFbGVtZW50OiB2YWx1ZS5pbnB1dHMubGVuZ3RoID4gMSA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQnV0dG9uLCB7IHNtYWxsOiB0cnVlLCBtaW5pbWFsOiB0cnVlLCBpbnRlbnQ6IFwiZGFuZ2VyXCIsIG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdJbnB1dHMgPSBbLi4udmFsdWUuaW5wdXRzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbnB1dHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGlucHV0czogbmV3SW5wdXRzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSB9LCBcIlhcIikpIDogbnVsbCB9KSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChyZWFjdF8yLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsXG4gICAgICAgICAgICBpbnB1dHMsXG4gICAgICAgICAgICBpbnB1dHMubGVuZ3RoIDwgNiA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQnV0dG9uLCB7IG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3SW5wdXRzID0gWy4uLnZhbHVlLmlucHV0c107XG4gICAgICAgICAgICAgICAgICAgIG5ld0lucHV0cy5wdXNoKGB2YWx1ZSR7bmV3SW5wdXRzLmxlbmd0aCArIDF9YCk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGlucHV0czogbmV3SW5wdXRzIH0pO1xuICAgICAgICAgICAgICAgIH0gfSwgXCJBZGQgaW5wdXRcIikpIDogbnVsbCkpO1xuICAgIH0sIFtvbkNoYW5nZSwgdmFsdWVdKTtcbiAgICBjb25zdCBjYXNlc0VsZW0gPSAoMCwgcmVhY3RfMS51c2VNZW1vKSgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhc2VzID0gdmFsdWUuY2FzZXMubWFwKChjYXNlXywgaSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChyZWFjdF8yLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgQ2FzZSBuby4gJHtpICsgMX0gbmFtZTpgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiBjYXNlXy5uYW1lLCByaWdodEVsZW1lbnQ6IHZhbHVlLmNhc2VzLmxlbmd0aCA+IDEgJiYgKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5CdXR0b24sIHsgc21hbGw6IHRydWUsIG1pbmltYWw6IHRydWUsIGludGVudDogXCJkYW5nZXJcIiwgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSwgXCJYXCIpKSwgb25DaGFuZ2U6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2FzZXMgPSBbLi4udmFsdWUuY2FzZXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzW2ldID0geyAuLi5uZXdDYXNlc1tpXSwgbmFtZTogZS50YXJnZXQudmFsdWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7IC4uLnZhbHVlLCBjYXNlczogbmV3Q2FzZXMgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IH0pKSxcbiAgICAgICAgICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGtleTogaSwgbGFiZWw6IGBDYXNlIG5vLiAke2kgKyAxfSBjb25kaXRpb24gZXhwcmVzc2lvbjpgLCBoZWxwZXJUZXh0OiBcIlRoZSBjb25kaXRpb24gdG8gZXZhbHVhdGUgdG8gY2hlY2sgd2hldGhlciB0aGlzIGNhc2Ugc2hvdWxkIGJlIGFjdGl2YXRlZC4gYW55IEpTIGV4cHJlc3Npb24uIFlvdSBjYW4gYWNjZXNzIHRoZSBpbnB1dHMgZGF0YSB1c2luZyB0aGUgaW5wdXRzIG9iamVjdC4gRm9yIGV4YW1wbGUsIGBpbnB1dHMubmFtZSAhPT0gaW5wdXRzWydjaXR5IG9mIGJpcnRoJ11gXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IGNhc2VfLmNvbmRpdGlvbkV4cHJlc3Npb24sIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nhc2VzID0gWy4uLnZhbHVlLmNhc2VzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXNlc1tpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ubmV3Q2FzZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbkV4cHJlc3Npb246IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSB9KSksXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgQ2FzZSBuby4gJHtpICsgMX0gb3V0cHV0IGV4cHJlc3Npb246YCwgaGVscGVyVGV4dDogXCJUaGUgZXhwcmVzc2lvbiB0byBvdXRwdXQgaWYgdGhpcyBjYXNlIGlzIGFjdGl2YXRlZC4gQWNjZXB0cyBhbnkgSlMgZXhwcmVzc2lvbi4gWW91IGNhbiBhY2Nlc3MgdGhlIGlucHV0cyBkYXRhIHVzaW5nIHRoZSBpbnB1dHMgb2JqZWN0LiBGb3IgZXhhbXBsZSwgYGlucHV0cy5uYW1lYFwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiBjYXNlXy5vdXRwdXRFeHByZXNzaW9uLCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FzZXNbaV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLm5ld0Nhc2VzW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGNhc2VzOiBuZXdDYXNlcyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gfSkpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIGNhc2VzLFxuICAgICAgICAgICAgY2FzZXMubGVuZ3RoIDwgTUFYX0NBU0VTID8gKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5CdXR0b24sIHsgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYGNhc2Uke25ld0Nhc2VzLmxlbmd0aCArIDF9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbkV4cHJlc3Npb246IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgIH0gfSwgXCJBZGQgY2FzZVwiKSkgOiBudWxsKSk7XG4gICAgfSwgW29uQ2hhbmdlLCB2YWx1ZV0pO1xuICAgIHJldHVybiAocmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQocmVhY3RfMi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLFxuICAgICAgICBpbnB1dHNFbGVtLFxuICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRGl2aWRlciwgbnVsbCksXG4gICAgICAgIGNhc2VzRWxlbSxcbiAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkRpdmlkZXIsIG51bGwpLFxuICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCBudWxsLFxuICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkNoZWNrYm94LCB7IGNoZWNrZWQ6IHZhbHVlLmRlZmF1bHRDYXNlLmVuYWJsZWQsIGxhYmVsOiBcIkVuYWJsZSBkZWZhdWx0IGNhc2UgKGlmIG5vIGNhc2UgaXMgYWN0aXZhdGVkKS4gSWYgZGlzYWJsZWQsIHJlYWNoaW5nIGEgY2FzZSB0aGF0IGlzIG5vdCBhY3RpdmF0ZWQgd2lsbCBvdXRwdXQgYW4gZXJyb3IuXCIsIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmFibGVkID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Q2FzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0RXhwcmVzc2lvbjogZW5hYmxlZCA/IFwiXCIgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IH0pKSxcbiAgICAgICAgdmFsdWUuZGVmYXVsdENhc2UuZW5hYmxlZCA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkRlZmF1bHQgY2FzZSBvdXRwdXQgZXhwcmVzc2lvbjpcIiwgaGVscGVyVGV4dDogXCJUaGUgZXhwcmVzc2lvbiB0byBvdXRwdXQgaWYgbm8gY2FzZSBpcyBhY3RpdmF0ZWQuIEFjY2VwdHMgYW55IEpTIGV4cHJlc3Npb24uIFlvdSBjYW4gYWNjZXNzIHRoZSBpbnB1dHMgZGF0YSB1c2luZyB0aGUgaW5wdXRzIG9iamVjdC4gRm9yIGV4YW1wbGUsIGBpbnB1dHMubmFtZWBcIiB9LFxuICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLmRlZmF1bHRDYXNlLm91dHB1dEV4cHJlc3Npb24sIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRDYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gfSkpKSA6IG51bGwpKTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IFN3aXRjaEVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fU3dpdGNoLy4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIlJlYWN0Il07CgovKioqLyB9KQoKLyoqKioqKi8gCX0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJCi8qKioqKiovIAkvLyBzdGFydHVwCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCS8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oIi4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fU3dpdGNoID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKLyoqKioqKi8gCQovKioqKioqLyB9KSgpCjs="};